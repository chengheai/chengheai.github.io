<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CHI1130</title>
  
  <subtitle>ä¸šç²¾äºå‹¤ï¼Œè’äºå¬‰ï¼›è¡Œæˆäºæ€ï¼Œæ¯äºéš</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://github.com/chengheai/"/>
  <updated>2022-02-15T12:49:34.347Z</updated>
  <id>https://github.com/chengheai/</id>
  
  <author>
    <name>HEAI</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>el-tableåŠ¨æ€åˆå¹¶å•å…ƒæ ¼</title>
    <link href="https://github.com/chengheai/2022/02/15/el-table%E5%8A%A8%E6%80%81%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC/"/>
    <id>https://github.com/chengheai/2022/02/15/el-tableåŠ¨æ€åˆå¹¶å•å…ƒæ ¼/</id>
    <published>2022-02-15T12:36:30.000Z</published>
    <updated>2022-02-15T12:49:34.347Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éœ€æ±‚èƒŒæ™¯"><a href="#éœ€æ±‚èƒŒæ™¯" class="headerlink" title="éœ€æ±‚èƒŒæ™¯"></a>éœ€æ±‚èƒŒæ™¯</h2><ul><li><p>æ‰¹é‡åˆ›å»ºå¤šä¸ªè®¡åˆ’ï¼ˆplanï¼‰ï¼Œè®¡åˆ’æŒ‰ç»„ï¼ˆgroupï¼‰è¿›è¡Œåˆ†é…ï¼Œè®¡åˆ’åˆ›å»ºå®Œæˆä¹‹åå¯ä»¥ä¿®æ”¹ï¼Œåˆ é™¤</p></li><li><p>æ¯ä¸ªç»„ç¬¬ä¸€åˆ—å•å…ƒæ ¼åˆå¹¶æ˜¾ç¤ºç¬¬å‡ ç»„ï¼Œç»„å†…æ·»åŠ å…¨é€‰/åé€‰ç»„ä¸‹é¢çš„è®¡åˆ’</p></li><li><p>ç»„å†…è®¡åˆ’åˆ é™¤å®Œäº†ä¹‹åç»„åˆ é™¤</p></li></ul><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><p><a href="https://chengheai.github.io/daily-vue-demo/#/span-table" target="_blank" rel="noopener">åœ¨çº¿æµ‹è¯•</a><br><a href="https://github.com/chengheai/daily-vue-demo">ä»£ç github</a></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"padding:0 20px"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:inline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">"formInline"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:rules</span>=<span class="string">"rules"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"demo-form-inline"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"å¹¿å‘Šæ•°"</span> <span class="attr">prop</span>=<span class="string">"ad"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"formInline.ad"</span> <span class="attr">placeholder</span>=<span class="string">"å¹¿å‘Šæ•°"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"å¹¿å‘Šç»„å†…å¹¿å‘Šæ•°"</span> <span class="attr">prop</span>=<span class="string">"each"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"formInline.each"</span> <span class="attr">placeholder</span>=<span class="string">"å¹¿å‘Šç»„æ•°"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>ç”Ÿæˆæ•°æ®<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-divider</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">"tableData"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:span-method</span>=<span class="string">"objectSpanMethod"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">border</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"width: 100%"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:max-height</span>=<span class="string">"650"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"group"</span> <span class="attr">label</span>=<span class="string">"ç»„id"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"id"</span> <span class="attr">label</span>=<span class="string">"è®¡åˆ’id"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"name"</span> <span class="attr">label</span>=<span class="string">"å§“å"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"province"</span> <span class="attr">label</span>=<span class="string">"çœå¸‚"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"address"</span> <span class="attr">label</span>=<span class="string">"åœ°å€"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">"right"</span> <span class="attr">label</span>=<span class="string">"æ“ä½œ"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"handleUpdate(scope.row, 'edit')"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">            &gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"handleUpdate(scope.row, 'del')"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"danger"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">            &gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DialogUpdate</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:payload</span>=<span class="string">"payload"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:visible.sync</span>=<span class="string">"dialogVisible"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">submit</span>=<span class="string">"handleSubmit"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> DialogUpdate <span class="keyword">from</span> <span class="string">"./DialogUpdate"</span>;</span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  name: <span class="string">"ç‹å°è™"</span>,</span><br><span class="line">  province: <span class="string">"ä¸Šæµ·"</span>,</span><br><span class="line">  city: <span class="string">"æ™®é™€åŒº"</span>,</span><br><span class="line">  address: <span class="string">"ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1518 å¼„"</span>,</span><br><span class="line">  zip: <span class="number">200333</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123; DialogUpdate &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">const</span> validatePass = <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"this.formInline: "</span>, <span class="keyword">this</span>.formInline);</span><br><span class="line">      <span class="keyword">const</span> &#123; ad, each &#125; = <span class="keyword">this</span>.formInline;</span><br><span class="line">      <span class="keyword">if</span> (+ad &lt; +each) &#123;</span><br><span class="line">        callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"æ¯ç»„å†…æ•°å°äºè®¡åˆ’æ•°"</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      payload: &#123;&#125;,</span><br><span class="line">      dialogVisible: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">      formInline: &#123;</span><br><span class="line">        ad: <span class="number">20</span>,</span><br><span class="line">        each: <span class="number">2</span></span><br><span class="line">      &#125;,</span><br><span class="line">      table: [],</span><br><span class="line">      rules: &#123;</span><br><span class="line">        ad: [</span><br><span class="line">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"å¹¿å‘Šæ•°"</span>, <span class="attr">trigger</span>: <span class="string">"change"</span> &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            pattern: <span class="regexp">/^(\d+)(\d+)?$/</span>,</span><br><span class="line">            message: <span class="string">"è¯·è¾“å…¥æ•°å­—"</span>,</span><br><span class="line">            trigger: <span class="string">"change"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123; <span class="attr">validator</span>: validatePass, <span class="attr">trigger</span>: <span class="string">"change"</span> &#125;</span><br><span class="line">        ],</span><br><span class="line">        each: [</span><br><span class="line">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"å¹¿å‘Šç»„æ•°"</span>, <span class="attr">trigger</span>: <span class="string">"change"</span> &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            pattern: <span class="regexp">/^(\d+)(\d+)?$/</span>,</span><br><span class="line">            message: <span class="string">"è¯·è¾“å…¥æ•°å­—"</span>,</span><br><span class="line">            trigger: <span class="string">"change"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123; <span class="attr">validator</span>: validatePass, <span class="attr">trigger</span>: <span class="string">"change"</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    tableData: &#123;</span><br><span class="line">      <span class="keyword">get</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.table.map(<span class="function">(<span class="params">row, index</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (index === count) &#123;</span><br><span class="line">            <span class="keyword">const</span> len = <span class="keyword">this</span>.table.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.group === row.group)</span><br><span class="line">              .length;</span><br><span class="line">            count += len;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">              ...row,</span><br><span class="line">              rowspan: len,</span><br><span class="line">              colspan: <span class="number">1</span></span><br><span class="line">            &#125;;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            ...row,</span><br><span class="line">            colspan: <span class="number">0</span>,</span><br><span class="line">            rowspan: <span class="number">0</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    <span class="keyword">this</span>.onSubmit();</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleUpdate(row, action) &#123;</span><br><span class="line">      <span class="keyword">if</span> (action === <span class="string">"del"</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.table = <span class="keyword">this</span>.table.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> ![row.id].includes(item.id);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.payload = &#123; ...row &#125;;</span><br><span class="line">        <span class="keyword">this</span>.dialogVisible = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSubmit(p) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"p: "</span>, p);</span><br><span class="line">      <span class="keyword">this</span>.table = <span class="keyword">this</span>.table.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> [p].find(<span class="function"><span class="params">i</span> =&gt;</span> i.id === item.id) || item;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"this.table: "</span>, <span class="keyword">this</span>.table);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">this</span>.dialogVisible = <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    objectSpanMethod(&#123; row, columnIndex &#125;) &#123;</span><br><span class="line">      <span class="keyword">if</span> (columnIndex === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          rowspan: row.rowspan,</span><br><span class="line">          colspan: row.colspan</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line">      <span class="keyword">let</span> group = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">this</span>.table = [...Array(+<span class="keyword">this</span>.formInline.ad).fill(obj)].map(</span><br><span class="line">        (item, index) =&gt; &#123;</span><br><span class="line">          group = <span class="built_in">Math</span>.floor(index / +<span class="keyword">this</span>.formInline.each) + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            ...item,</span><br><span class="line">            id: <span class="string">`id_<span class="subst">$&#123;index&#125;</span>`</span>,</span><br><span class="line">            group: <span class="string">`group_<span class="subst">$&#123;group&#125;</span>`</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"submit!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;éœ€æ±‚èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#éœ€æ±‚èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚èƒŒæ™¯&quot;&gt;&lt;/a&gt;éœ€æ±‚èƒŒæ™¯&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æ‰¹é‡åˆ›å»ºå¤šä¸ªè®¡åˆ’ï¼ˆplanï¼‰ï¼Œè®¡åˆ’æŒ‰ç»„ï¼ˆgroupï¼‰è¿›è¡Œåˆ†é…ï¼Œè®¡åˆ’åˆ›å»ºå®Œæˆä¹‹åå¯ä»¥ä¿®æ”¹ï¼Œåˆ é™¤&lt;/p&gt;
&lt;/
      
    
    </summary>
    
    
      <category term="vue" scheme="https://github.com/chengheai/tags/vue/"/>
    
      <category term="element-ui" scheme="https://github.com/chengheai/tags/element-ui/"/>
    
  </entry>
  
  <entry>
    <title>mockjsç”Ÿæˆå›¾ç‰‡æç¤ºToo big of an image!</title>
    <link href="https://github.com/chengheai/2021/11/25/mockjs%E7%94%9F%E6%88%90%E5%9B%BE%E7%89%87%E6%8F%90%E7%A4%BA/"/>
    <id>https://github.com/chengheai/2021/11/25/mockjsç”Ÿæˆå›¾ç‰‡æç¤º/</id>
    <published>2021-11-25T13:55:28.000Z</published>
    <updated>2021-11-25T14:05:38.353Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h2><p><a href="https://dummyimage.com/200x100" target="_blank" rel="noopener">æ­£ç¡®çš„ ğŸ¦‘ https://dummyimage.com/200x100</a><br><a href="https://dummyimage.com/200Ã—100" target="_blank" rel="noopener">é”™è¯¯çš„ ğŸ™ https://dummyimage.com/200Ã—100</a></p><blockquote><p>ç»è¿‡å¯¹æ¯”å‘ç°æ˜¯ x ç¬¦å·çš„é—®é¢˜</p></blockquote><h2 id="ä»£ç ä¿®æ”¹"><a href="#ä»£ç ä¿®æ”¹" class="headerlink" title="ä»£ç ä¿®æ”¹"></a>ä»£ç ä¿®æ”¹</h2><p>ç›´æ¥ replace æ›¿æ¢å°±å¥½äº†<br><a href="https://blog.stack021.cn/daily-react-demo/#/users" target="_blank" rel="noopener">åœ¨çº¿ DEMO</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Mock = <span class="built_in">require</span>(<span class="string">'mockjs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="string">'GET /mock/api/users'</span>: Mock.mock(&#123;</span><br><span class="line">    status: <span class="string">'success'</span>,</span><br><span class="line">    <span class="string">'list|20-40'</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="string">'@id'</span>, <span class="comment">//éšæœºid</span></span><br><span class="line">        name: <span class="string">'@cname'</span>, <span class="comment">//éšæœºåç§°</span></span><br><span class="line">        nickName: <span class="string">'@clast'</span>, <span class="comment">// éšæœºæ˜µç§°</span></span><br><span class="line">        phone: <span class="regexp">/^1[34578]\d&#123;9&#125;$/</span>, <span class="comment">//éšæœºç”µè¯å·ç </span></span><br><span class="line">        <span class="string">'level|1-5'</span>: <span class="number">1</span>, <span class="comment">//ç­‰çº§</span></span><br><span class="line">        address: <span class="string">'@county(true)'</span>, <span class="comment">//éšæœºåœ°å€</span></span><br><span class="line">        email: <span class="string">'@email'</span>, <span class="comment">//éšæœºé‚®ç®±</span></span><br><span class="line">        <span class="string">'sex|0-2'</span>: <span class="number">2</span>, <span class="comment">//éšæœºæ€§åˆ«</span></span><br><span class="line">        createTime: <span class="string">'@datetime'</span>, <span class="comment">//åˆ›å»ºæ—¶é—´</span></span><br><span class="line">        info() &#123;</span><br><span class="line">          <span class="keyword">return</span> Mock.Random.cparagraph()</span><br><span class="line">        &#125;, <span class="comment">// è¯´æ˜</span></span><br><span class="line">        avatar() &#123;</span><br><span class="line">          <span class="comment">//ç”¨æˆ·å¤´åƒ</span></span><br><span class="line">          <span class="keyword">return</span> Mock.Random.image(<span class="string">'100Ã—100'</span>, Mock.Random.color(), <span class="string">'#FFF'</span>, <span class="keyword">this</span>.nickName).replace(</span><br><span class="line">            <span class="string">'Ã—'</span>,</span><br><span class="line">            <span class="string">'x'</span></span><br><span class="line">          )</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¯¹æ¯”&quot;&gt;&lt;a href=&quot;#å¯¹æ¯”&quot; class=&quot;headerlink&quot; title=&quot;å¯¹æ¯”&quot;&gt;&lt;/a&gt;å¯¹æ¯”&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://dummyimage.com/200x100&quot; target=&quot;_blank&quot; rel=&quot;noopener
      
    
    </summary>
    
    
      <category term="mockjs" scheme="https://github.com/chengheai/tags/mockjs/"/>
    
  </entry>
  
  <entry>
    <title>image!</title>
    <link href="https://github.com/chengheai/2021/11/25/image/"/>
    <id>https://github.com/chengheai/2021/11/25/image/</id>
    <published>2021-11-25T13:54:44.000Z</published>
    <updated>2021-11-25T13:54:44.080Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>vueå®ç°æ ‘å½¢treeå±•ç¤ºç»„ä»¶å°è£…</title>
    <link href="https://github.com/chengheai/2021/11/02/vue%E5%AE%9E%E7%8E%B0%E6%A0%91%E5%BD%A2tree%E5%B1%95%E7%A4%BA%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85/"/>
    <id>https://github.com/chengheai/2021/11/02/vueå®ç°æ ‘å½¢treeå±•ç¤ºç»„ä»¶å°è£…/</id>
    <published>2021-11-02T14:04:45.000Z</published>
    <updated>2021-11-02T14:17:03.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><a href="https://blog.stack021.cn/daily-vue-demo/#/tree1" target="_blank" rel="noopener">åœ¨çº¿demoğŸš€ğŸ </a></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://github.com/chengheai/review-demo-image/blob/master/2021-11-02%2022-01-06.2021-11-02%2022_01_56.gif?raw=true" alt title>                </div>                <div class="image-caption"></div>            </figure><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><blockquote><p>TreeItem.vue</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"tree-item"</span>&gt;</span><br><span class="line">    &lt;div @click=<span class="string">"handleToggle"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"tree-title"</span>&gt;</span><br><span class="line">      &lt;i v-<span class="keyword">if</span>=<span class="string">"hasChild"</span> :<span class="class"><span class="keyword">class</span></span>=<span class="string">"open?'el-icon-remove-outline':'el-icon-circle-plus-outline'"</span>&gt;&lt;<span class="regexp">/i&gt;</span></span><br><span class="line"><span class="regexp">      &lt;h4&gt;&#123;&#123; list.label &#125;&#125;&lt;/</span>h4&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div v-show='open'  class="child-content"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;tree-item</span></span><br><span class="line"><span class="regexp">        v-for="(item, index) in list.children"</span></span><br><span class="line"><span class="regexp">        :list="item"</span></span><br><span class="line"><span class="regexp">        :key="index"</span></span><br><span class="line"><span class="regexp">      &gt;&lt;/</span>tree-item&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  name: "TreeItem",</span></span><br><span class="line"><span class="regexp">  props: &#123;</span></span><br><span class="line"><span class="regexp">    list: &#123;</span></span><br><span class="line"><span class="regexp">      type: [Object, Array],</span></span><br><span class="line"><span class="regexp">      required: true</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  data() &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      open: false</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  computed: &#123;</span></span><br><span class="line"><span class="regexp">    hasChild() &#123;</span></span><br><span class="line"><span class="regexp">      return this.list.children &amp;&amp; this.list.children.length;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  methods: &#123;</span></span><br><span class="line"><span class="regexp">    handleToggle() &#123;</span></span><br><span class="line"><span class="regexp">      if (this.hasChild) &#123;</span></span><br><span class="line"><span class="regexp">        this.open = !this.open;</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=<span class="string">'less'</span> scoped&gt;</span><br><span class="line">.tree-item&#123;</span><br><span class="line">  font-size: <span class="number">20</span>px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  .tree-title&#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: flex-start;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.child-content&#123;</span><br><span class="line">  margin-left: <span class="number">50</span>px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Tree.vue</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"tree-wrap"</span>&gt;</span><br><span class="line">    &lt;div v-<span class="keyword">for</span>=<span class="string">"(item, index) in dataSource"</span> :key=<span class="string">"index"</span>&gt;</span><br><span class="line">      &lt;tree-item :list=<span class="string">"item"</span>&gt;&lt;<span class="regexp">/tree-item&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> TreeItem <span class="keyword">from</span> <span class="string">"./TreeItem"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'tree'</span>,</span><br><span class="line">  props: &#123;</span><br><span class="line">    dataSource: &#123;</span><br><span class="line">      type: [<span class="built_in">Object</span>, <span class="built_in">Array</span>],</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    TreeItem</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;style scoped&gt;</span></span><br><span class="line"><span class="regexp">.tree-wrap&#123;</span></span><br><span class="line"><span class="regexp">  width: 100%;</span></span><br><span class="line"><span class="regexp">  /</span>* padding: <span class="number">0</span> <span class="number">50</span>px; *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure><blockquote><p>your component.vue</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"tree-w"</span>&gt;</span><br><span class="line">     &lt;x-tree :data-source=<span class="string">"myData"</span>&gt;&lt;<span class="regexp">/x-tree&gt;</span></span><br><span class="line"><span class="regexp">   &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import xTree from './</span>Tree.vue<span class="string">'</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  name: '</span>trees<span class="string">',</span></span><br><span class="line"><span class="string">  components: &#123;</span></span><br><span class="line"><span class="string">    xTree</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  data() &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">      myData: [&#123;</span></span><br><span class="line"><span class="string">        label: '</span>ä¸€çº§ <span class="number">1</span><span class="string">',</span></span><br><span class="line"><span class="string">        children: [&#123;</span></span><br><span class="line"><span class="string">          label: '</span>äºŒçº§ <span class="number">1</span><span class="number">-1</span><span class="string">',</span></span><br><span class="line"><span class="string">          children: [&#123;</span></span><br><span class="line"><span class="string">            label: '</span>ä¸‰çº§ <span class="number">1</span><span class="number">-1</span><span class="number">-1</span><span class="string">'</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;]</span></span><br><span class="line"><span class="string">      &#125;, &#123;</span></span><br><span class="line"><span class="string">        label: '</span>ä¸€çº§ <span class="number">2</span><span class="string">',</span></span><br><span class="line"><span class="string">        children: [&#123;</span></span><br><span class="line"><span class="string">          label: '</span>äºŒçº§ <span class="number">2</span><span class="number">-1</span><span class="string">',</span></span><br><span class="line"><span class="string">          children: [&#123;</span></span><br><span class="line"><span class="string">            label: '</span>ä¸‰çº§ <span class="number">2</span><span class="number">-1</span><span class="number">-1</span><span class="string">'</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;, &#123;</span></span><br><span class="line"><span class="string">          label: '</span>äºŒçº§ <span class="number">2</span><span class="number">-2</span><span class="string">',</span></span><br><span class="line"><span class="string">          children: [&#123;</span></span><br><span class="line"><span class="string">            label: '</span>ä¸‰çº§ <span class="number">2</span><span class="number">-2</span><span class="number">-1</span><span class="string">'</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;]</span></span><br><span class="line"><span class="string">      &#125;, &#123;</span></span><br><span class="line"><span class="string">        label: '</span>ä¸€çº§ <span class="number">3</span><span class="string">',</span></span><br><span class="line"><span class="string">        children: [&#123;</span></span><br><span class="line"><span class="string">          label: '</span>äºŒçº§ <span class="number">3</span><span class="number">-1</span><span class="string">',</span></span><br><span class="line"><span class="string">          children: [&#123;</span></span><br><span class="line"><span class="string">            label: '</span>ä¸‰çº§ <span class="number">3</span><span class="number">-1</span><span class="number">-1</span><span class="string">'</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;, &#123;</span></span><br><span class="line"><span class="string">          label: '</span>äºŒçº§ <span class="number">3</span><span class="number">-2</span><span class="string">',</span></span><br><span class="line"><span class="string">          children: [&#123;</span></span><br><span class="line"><span class="string">            label: '</span>ä¸‰çº§ <span class="number">3</span><span class="number">-2</span><span class="number">-1</span><span class="string">'</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;]</span></span><br><span class="line"><span class="string">      &#125;],</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;style&gt;</span></span><br><span class="line"><span class="string">.tree-w&#123;</span></span><br><span class="line"><span class="string">  padding: 50px;</span></span><br><span class="line"><span class="string">  padding-left: 200px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ•ˆæœ&quot;&gt;&lt;a href=&quot;#æ•ˆæœ&quot; class=&quot;headerlink&quot; title=&quot;æ•ˆæœ&quot;&gt;&lt;/a&gt;æ•ˆæœ&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://blog.stack021.cn/daily-vue-demo/#/tree1&quot; target=&quot;_bla
      
    
    </summary>
    
    
      <category term="vue" scheme="https://github.com/chengheai/tags/vue/"/>
    
      <category term="tree" scheme="https://github.com/chengheai/tags/tree/"/>
    
  </entry>
  
  <entry>
    <title>nodejsæœåŠ¡è·å–å¾®ä¿¡ç”¨æˆ·openid</title>
    <link href="https://github.com/chengheai/2021/10/26/nodejs%E6%9C%8D%E5%8A%A1%E8%8E%B7%E5%8F%96%E5%BE%AE%E4%BF%A1%E7%94%A8%E6%88%B7openid/"/>
    <id>https://github.com/chengheai/2021/10/26/nodejsæœåŠ¡è·å–å¾®ä¿¡ç”¨æˆ·openid/</id>
    <published>2021-10-26T08:18:42.000Z</published>
    <updated>2021-10-26T09:30:31.242Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰ç«¯ä»£ç "><a href="#å‰ç«¯ä»£ç " class="headerlink" title="å‰ç«¯ä»£ç "></a>å‰ç«¯ä»£ç </h2><blockquote><p>æ¥å£å‘é€codeå°±å¯ä»¥</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"brn-wrap"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"uni-btn-v"</span> <span class="attr">v-if</span>=<span class="string">"!hasLogin"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"handleBeforeLogin"</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"uni-btn-v"</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"handleTitleClick"</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; requestLogin &#125; <span class="keyword">from</span> <span class="string">'@/utils/str.js'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">      type: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">'æäº¤å‘å¸ƒ'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      hasLogin: <span class="literal">false</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleTitleClick() &#123;</span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">'submit'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleBeforeLogin() &#123;</span><br><span class="line">      <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">      <span class="comment">// æ¨èä½¿ç”¨wx.getUserProfileè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¼€å‘è€…æ¯æ¬¡é€šè¿‡è¯¥æ¥å£è·å–ç”¨æˆ·ä¸ªäººä¿¡æ¯å‡éœ€ç”¨æˆ·ç¡®è®¤</span></span><br><span class="line">      <span class="comment">// å¼€å‘è€…å¦¥å–„ä¿ç®¡ç”¨æˆ·å¿«é€Ÿå¡«å†™çš„å¤´åƒæ˜µç§°ï¼Œé¿å…é‡å¤å¼¹çª—</span></span><br><span class="line">      wx.getUserProfile(&#123;</span><br><span class="line">        desc: <span class="string">'ç”¨äºå®Œå–„ç”¨æˆ·èµ„æ–™'</span>, <span class="comment">// å£°æ˜è·å–ç”¨æˆ·ä¸ªäººä¿¡æ¯åçš„ç”¨é€”ï¼Œåç»­ä¼šå±•ç¤ºåœ¨å¼¹çª—ä¸­ï¼Œè¯·è°¨æ…å¡«å†™</span></span><br><span class="line">        success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(res);</span><br><span class="line">          that.doLogin(res);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    doLogin(detail) &#123;</span><br><span class="line">      <span class="keyword">const</span> self = <span class="keyword">this</span>;</span><br><span class="line">      <span class="keyword">if</span> (detail.errMsg === <span class="string">'getUserProfile:ok'</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'==='</span>, detail);</span><br><span class="line">        <span class="keyword">const</span> options = wx.getLaunchOptionsSync();</span><br><span class="line">        <span class="keyword">const</span> scene = options.scene + <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (scene.startsWith(<span class="string">'CRLAND:'</span>)) &#123;</span><br><span class="line">          detail.userInfo.scene = scene.substr(<span class="number">7</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        requestLogin().then(<span class="keyword">async</span> data =&gt; &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'========'</span>, detail.userInfo);</span><br><span class="line">          <span class="keyword">const</span> obj = &#123;</span><br><span class="line">            ...detail.userInfo,</span><br><span class="line">            userInfo: detail.rawData,</span><br><span class="line">            code: data.code</span><br><span class="line">          &#125;;</span><br><span class="line">          <span class="keyword">const</span> &#123; code, result &#125; = <span class="keyword">await</span> <span class="keyword">this</span>.$api.user.login(obj);</span><br><span class="line">          <span class="keyword">if</span> (code === <span class="number">200</span>) &#123;</span><br><span class="line">            uni.setStorageSync(<span class="string">'userInfo'</span>, <span class="built_in">JSON</span>.stringify(detail.userInfo));</span><br><span class="line">            uni.setStorageSync(<span class="string">'token'</span>, result.token);</span><br><span class="line">            uni.setStorageSync(<span class="string">'userId'</span>, result.userId);</span><br><span class="line">            <span class="keyword">this</span>.hasLogin =<span class="literal">true</span>;</span><br><span class="line">            uni.switchTab(&#123;</span><br><span class="line">              url: <span class="string">'/pages/index/index'</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            uni.showModal(&#123;</span><br><span class="line">              title: <span class="string">'æç¤º'</span>,</span><br><span class="line">              content: e.msg || <span class="string">'ç™»å½•å¤±è´¥'</span>,</span><br><span class="line">              showCancel: <span class="literal">false</span>,</span><br><span class="line">              confirmText: <span class="string">'ç¡®å®š'</span>,</span><br><span class="line">              success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;&#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="åç«¯ä»£ç "><a href="#åç«¯ä»£ç " class="headerlink" title="åç«¯ä»£ç "></a>åç«¯ä»£ç </h2><blockquote><p>åç«¯åªéœ€è¦æ‹¿åˆ°codeå°±å¯ä»¥ï¼Œcodeä¸èƒ½äºŒæ¬¡ä½¿ç”¨</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'https'</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.Router()</span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>)</span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">'querystring'</span>)</span><br><span class="line"><span class="keyword">const</span> User = <span class="built_in">require</span>(<span class="string">'../models/User'</span>) <span class="comment">//å¼•å…¥æ¨¡å—æ¨¡å‹</span></span><br><span class="line"><span class="keyword">const</span> vertoken = <span class="built_in">require</span>(<span class="string">'../utils/token'</span>) <span class="comment">//å¼•å…¥token</span></span><br><span class="line"><span class="keyword">const</span> wx = <span class="built_in">require</span>(<span class="string">'../config/wx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">router.post(<span class="string">'/login'</span>, (_req, _res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(_req.body, <span class="string">' é¡µé¢ä¼ å…¥å‚æ•°'</span>)</span><br><span class="line">  <span class="keyword">let</span> user = <span class="built_in">Object</span>.assign(&#123;&#125;, _req.body)</span><br><span class="line">  <span class="keyword">var</span> query = &#123;</span><br><span class="line">    appid: wx.appid,</span><br><span class="line">    secret: wx.secret,</span><br><span class="line">    js_code: _req.body.code,</span><br><span class="line">    grant_type: <span class="string">'authorization_code'</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> content = qs.stringify(query)</span><br><span class="line">  <span class="keyword">var</span> options = &#123;</span><br><span class="line">    hostname: <span class="string">'api.weixin.qq.com'</span>,</span><br><span class="line">    port: <span class="string">''</span>,</span><br><span class="line">    path: <span class="string">'/sns/jscode2session?'</span> + content,</span><br><span class="line">    method: <span class="string">'GET'</span>,</span><br><span class="line">    header: &#123;</span><br><span class="line">      <span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> req = http.request(options, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    res.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">_data</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'_data: '</span>, _data)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> parsData = <span class="built_in">JSON</span>.parse(_data.toString())</span><br><span class="line">      <span class="keyword">const</span> &#123; openid &#125; = parsData</span><br><span class="line">      User.find(</span><br><span class="line">        &#123;</span><br><span class="line">          openid,</span><br><span class="line">        &#125;,</span><br><span class="line">        (err, users) =&gt; &#123;</span><br><span class="line">          <span class="keyword">if</span> (users &amp;&amp; users.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            vertoken.setToken(users[<span class="number">0</span>]._id, users[<span class="number">0</span>].openid).then(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;</span><br><span class="line">              _res.json(&#123;</span><br><span class="line">                code: <span class="number">200</span>,</span><br><span class="line">                result: &#123;</span><br><span class="line">                  token,</span><br><span class="line">                  userId:users[<span class="number">0</span>]._id</span><br><span class="line">                &#125;,</span><br><span class="line">                message: <span class="string">'ç™»å½•æˆåŠŸ'</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            user.openid = openid</span><br><span class="line">            <span class="keyword">new</span> User(user).save().then(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">              vertoken.setToken(val._id, openid).then(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;</span><br><span class="line">                _res.json(&#123;</span><br><span class="line">                  code: <span class="number">200</span>,</span><br><span class="line">                  result: &#123;</span><br><span class="line">                    token,</span><br><span class="line">                    userId:val._id</span><br><span class="line">                  &#125;,</span><br><span class="line">                  message: <span class="string">'ç™»å½•æˆåŠŸ'</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      )</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  req.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'problem with request: '</span> + e.message)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  req.end()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><a href="https://github.com/chengheai/mini-write-messages">å‰ç«¯</a><br><a href="https://github.com/chengheai/mini-messages-server">nodeæœåŠ¡ç«¯</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰ç«¯ä»£ç &quot;&gt;&lt;a href=&quot;#å‰ç«¯ä»£ç &quot; class=&quot;headerlink&quot; title=&quot;å‰ç«¯ä»£ç &quot;&gt;&lt;/a&gt;å‰ç«¯ä»£ç &lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;æ¥å£å‘é€codeå°±å¯ä»¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;high
      
    
    </summary>
    
    
      <category term="node" scheme="https://github.com/chengheai/tags/node/"/>
    
      <category term="å°æŠ€å·§" scheme="https://github.com/chengheai/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>nginxhttpè½¬https</title>
    <link href="https://github.com/chengheai/2021/10/25/http%E8%BD%AChttps/"/>
    <id>https://github.com/chengheai/2021/10/25/httpè½¬https/</id>
    <published>2021-10-25T14:11:16.000Z</published>
    <updated>2021-10-26T09:26:35.321Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸŸåã€å­åŸŸåã€sslè¯ä¹¦"><a href="#åŸŸåã€å­åŸŸåã€sslè¯ä¹¦" class="headerlink" title="åŸŸåã€å­åŸŸåã€sslè¯ä¹¦"></a>åŸŸåã€å­åŸŸåã€sslè¯ä¹¦</h2><blockquote><p>åŸŸåå­åŸŸåçš„å¼€é€šç½‘ä¸Šæ‰¾æ‰¾éƒ½æœ‰ï¼Œå¾ˆç®€å•ï¼Œè¿™é‡Œä¸»è¦è®²è¯ä¹¦çš„é—®é¢˜</p></blockquote><p>ä¸€ä¸ªåŸŸåä¸€ä¸ªè¯ä¹¦</p><blockquote><p>å»ºè®®åˆ›å»ºä¸€ä¸ªmy_configsæ–‡ä»¶å¤¹é‡Œé¢æ”¾å„ç§é¡¹ç›®é…ç½®xx.conf åœ¨nginx.conf #gzip  on;ä¸‹é¢ æ·»åŠ  include ./my_configs/*.conf;</p></blockquote><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">  <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">  <span class="attribute">server_name</span> demo.xxx.cn;</span><br><span class="line">  <span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">rewrite</span> (.*) https://demo.xxx.cn.cn<span class="variable">$1</span> <span class="literal">permanent</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">server_name</span> demo.xxx.cn.cn;</span><br><span class="line">    <span class="attribute">root</span> html;</span><br><span class="line">    <span class="attribute">index</span> index.html index.htm;</span><br><span class="line">    <span class="attribute">ssl_certificate</span> /usr/local/nginx/conf/ssl/8746281_demo.xxx.cn.cn.pem; <span class="comment"># path</span></span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /usr/local/nginx/conf/ssl/8746281_demo.xxx.cn.cn.key; <span class="comment"># path</span></span><br><span class="line">    <span class="attribute">ssl_session_timeout</span> <span class="number">5m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    <span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">       <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">       <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">       <span class="attribute">proxy_pass</span> http://0.0.0.0:8899;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;åŸŸåã€å­åŸŸåã€sslè¯ä¹¦&quot;&gt;&lt;a href=&quot;#åŸŸåã€å­åŸŸåã€sslè¯ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;åŸŸåã€å­åŸŸåã€sslè¯ä¹¦&quot;&gt;&lt;/a&gt;åŸŸåã€å­åŸŸåã€sslè¯ä¹¦&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;åŸŸåå­åŸŸåçš„å¼€é€šç½‘ä¸Šæ‰¾æ‰¾éƒ½æœ‰ï¼Œå¾ˆç®€
      
    
    </summary>
    
    
      <category term="nginx" scheme="https://github.com/chengheai/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>mongooseæ“ä½œæ•°æ®</title>
    <link href="https://github.com/chengheai/2021/10/25/mongoose%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE/"/>
    <id>https://github.com/chengheai/2021/10/25/mongooseæ“ä½œæ•°æ®/</id>
    <published>2021-10-25T14:10:47.000Z</published>
    <updated>2021-10-26T09:26:23.629Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h2><p><a href="https://mongoosejs.com/docs/guide.html" target="_blank" rel="noopener">å®˜ç½‘è‹±æ–‡æ–‡æ¡£</a><br><a href="http://www.mongoosejs.net/docs/guide.html" target="_blank" rel="noopener">å®˜ç½‘ä¸­æ–‡æ–‡æ¡£</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ–‡æ¡£&quot;&gt;&lt;a href=&quot;#æ–‡æ¡£&quot; class=&quot;headerlink&quot; title=&quot;æ–‡æ¡£&quot;&gt;&lt;/a&gt;æ–‡æ¡£&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://mongoosejs.com/docs/guide.html&quot; target=&quot;_blank&quot; rel=&quot;
      
    
    </summary>
    
    
      <category term="mongoose" scheme="https://github.com/chengheai/tags/mongoose/"/>
    
  </entry>
  
  <entry>
    <title>node serverå¦‚ä½•å®ç°ç™»å½•ç”ŸæˆtokenåŠæ¥å£æ ¡éªŒtoken</title>
    <link href="https://github.com/chengheai/2021/10/25/server%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E7%94%9F%E6%88%90token%E5%8F%8A%E6%8E%A5%E5%8F%A3%E6%A0%A1%E9%AA%8Ctoken/"/>
    <id>https://github.com/chengheai/2021/10/25/serverå¦‚ä½•å®ç°ç™»å½•ç”ŸæˆtokenåŠæ¥å£æ ¡éªŒtoken/</id>
    <published>2021-10-25T14:10:01.000Z</published>
    <updated>2021-10-26T09:25:07.464Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åˆ›å»ºæ–¹æ³•"><a href="#åˆ›å»ºæ–¹æ³•" class="headerlink" title="åˆ›å»ºæ–¹æ³•"></a>åˆ›å»ºæ–¹æ³•</h2><blockquote><p>åœ¨utilsä¸‹åˆ›å»ºä¸€ä¸ªtoken.js æŠ›å‡ºsetTokenï¼ŒgetTokenæ–¹æ³•</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">"jsonwebtoken"</span>);</span><br><span class="line"><span class="keyword">var</span> jwtSecret = <span class="string">"write messages"</span>; <span class="comment">//ç­¾å</span></span><br><span class="line"><span class="comment">//ç™»å½•æ¥å£ ç”Ÿæˆtokençš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> setToken = <span class="function"><span class="keyword">function</span>(<span class="params">_id, openid</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//expiresln è®¾ç½®tokenè¿‡æœŸçš„æ—¶é—´</span></span><br><span class="line">    <span class="comment">//&#123; openid: openid, _id: _id &#125; ä¼ å…¥éœ€è¦è§£æçš„å€¼ï¼ˆ ä¸€èˆ¬ä¸ºç”¨æˆ·åï¼Œç”¨æˆ·id ç­‰ï¼‰</span></span><br><span class="line">    <span class="keyword">const</span> rule = &#123; <span class="attr">_id</span>: _id, <span class="attr">openid</span>: openid &#125;;</span><br><span class="line">    <span class="comment">// const token = 'Bearer ' + jwt.sign(rule, jwtSecret, &#123; expiresIn: '36000' &#125;);</span></span><br><span class="line">    <span class="keyword">const</span> token = jwt.sign(rule, jwtSecret, &#123;<span class="attr">expiresIn</span>: <span class="string">'7d'</span>&#125;);</span><br><span class="line">    resolve(token);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å„ä¸ªæ¥å£éœ€è¦éªŒè¯tokençš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> getToken = <span class="function"><span class="keyword">function</span>(<span class="params">token</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"tokenæ˜¯ç©ºçš„"</span>);</span><br><span class="line">      reject(&#123;</span><br><span class="line">        error: <span class="string">"token æ˜¯ç©ºçš„"</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> info = jwt.verify(token, jwtSecret);</span><br><span class="line">      <span class="comment">// console.log('info: ', info);</span></span><br><span class="line">      resolve(info); <span class="comment">//è§£æè¿”å›çš„å€¼ï¼ˆsign ä¼ å…¥çš„å€¼ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  setToken,</span><br><span class="line">  getToken</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"><span class="keyword">const</span> Like = <span class="built_in">require</span>(<span class="string">'../models/Like'</span>) <span class="comment">//å¼•å…¥æ¨¡å—æ¨¡å‹</span></span><br><span class="line"><span class="keyword">var</span> vertoken = <span class="built_in">require</span>(<span class="string">'../utils/token'</span>) <span class="comment">//å¼•å…¥token</span></span><br><span class="line"><span class="comment">// ä¸ªäººç‚¹èµåˆ—è¡¨</span></span><br><span class="line">router.get(<span class="string">'/article/like/list'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  vertoken</span><br><span class="line">    .getToken(req.headers.token)</span><br><span class="line">    .then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      Like.find(&#123;</span><br><span class="line">        userId: data._id,</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(<span class="function">(<span class="params">likes</span>) =&gt;</span> &#123;</span><br><span class="line">          res.json(&#123;</span><br><span class="line">            code: <span class="number">200</span>,</span><br><span class="line">            result: &#123;</span><br><span class="line">              data: likes,</span><br><span class="line">            &#125;,</span><br><span class="line">            message: <span class="string">'è¯·æ±‚æˆåŠŸï¼'</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'err:'</span>, err)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'error:'</span>, error)</span><br><span class="line">      res.json(&#123; <span class="attr">code</span>: <span class="number">401</span>, <span class="attr">message</span>: <span class="string">'tokenå¤±æ•ˆäº†'</span> &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><a href="https://github.com/chengheai/mini-write-messages">å‰ç«¯</a><br><a href="https://github.com/chengheai/mini-messages-server">nodeæœåŠ¡ç«¯</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;åˆ›å»ºæ–¹æ³•&quot;&gt;&lt;a href=&quot;#åˆ›å»ºæ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;åˆ›å»ºæ–¹æ³•&quot;&gt;&lt;/a&gt;åˆ›å»ºæ–¹æ³•&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨utilsä¸‹åˆ›å»ºä¸€ä¸ªtoken.js æŠ›å‡ºsetTokenï¼ŒgetTokenæ–¹æ³•&lt;/p&gt;
&lt;/b
      
    
    </summary>
    
    
      <category term="token" scheme="https://github.com/chengheai/tags/token/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä½¿ç”¨multerå®ç°æ–‡ä»¶ä¸Šä¼ åŠå›æ˜¾</title>
    <link href="https://github.com/chengheai/2021/10/25/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8multer%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8F%8A%E5%9B%9E%E6%98%BE/"/>
    <id>https://github.com/chengheai/2021/10/25/å¦‚ä½•ä½¿ç”¨multerå®ç°æ–‡ä»¶ä¸Šä¼ åŠå›æ˜¾/</id>
    <published>2021-10-25T14:09:39.000Z</published>
    <updated>2021-10-26T09:29:06.128Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰ç«¯ä»£ç "><a href="#å‰ç«¯ä»£ç " class="headerlink" title="å‰ç«¯ä»£ç "></a>å‰ç«¯ä»£ç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"img-list"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-for</span>=<span class="string">"(i, index) in form.imgs"</span> <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"item-img mr20"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">image</span> <span class="attr">:src</span>=<span class="string">"RES_ROOT + i"</span> <span class="attr">mode</span>=<span class="string">"aspectFit"</span> @<span class="attr">click.native.stop</span>=<span class="string">"preImg(RES_ROOT + i)"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">uni-icons</span> <span class="attr">type</span>=<span class="string">"close"</span> <span class="attr">color</span>=<span class="string">"#606266"</span> <span class="attr">size</span>=<span class="string">"20"</span> <span class="attr">class</span>=<span class="string">"del-btn"</span> @<span class="attr">click</span>=<span class="string">"handleDel(index, i)"</span>&gt;</span><span class="tag">&lt;/<span class="name">uni-icons</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">"form.imgs.length &lt; 2"</span> <span class="attr">class</span>=<span class="string">"uni-hello-addfile f-c-c-c"</span> @<span class="attr">click</span>=<span class="string">"handleChooseImage"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uni-icons</span> <span class="attr">type</span>=<span class="string">"plusempty"</span> <span class="attr">color</span>=<span class="string">"#606266"</span> <span class="attr">size</span>=<span class="string">"24"</span> <span class="attr">class</span>=<span class="string">"mb12"</span>&gt;</span><span class="tag">&lt;/<span class="name">uni-icons</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span>&gt;</span>é€‰æ‹©å›¾ç‰‡<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤</span></span><br><span class="line">handleDel(index, row) &#123;</span><br><span class="line">  <span class="keyword">this</span>.form.imgs.splice(index, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(index, row);</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// é¢„è§ˆ</span></span><br><span class="line">preImg(logourl) &#123;</span><br><span class="line">  <span class="keyword">let</span> imgsArray = [];</span><br><span class="line">  imgsArray[<span class="number">0</span>] = logourl;</span><br><span class="line">  uni.previewImage(&#123;</span><br><span class="line">    current: <span class="number">0</span>,</span><br><span class="line">    urls: imgsArray</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// ä¸Šä¼ </span></span><br><span class="line">handleChooseImage() &#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">  uni.chooseImage(&#123;</span><br><span class="line">    count: <span class="number">2</span>,</span><br><span class="line">    sourceType: [<span class="string">'album'</span>, <span class="string">'camera'</span>],</span><br><span class="line">    success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'chooseImage success, temp path is'</span>, res.tempFilePaths[<span class="number">0</span>]);</span><br><span class="line">      <span class="keyword">var</span> imageSrc = res.tempFilePaths[<span class="number">0</span>];</span><br><span class="line">      uni.uploadFile(&#123;</span><br><span class="line">        url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>/api/file/upload`</span>,</span><br><span class="line">        filePath: imageSrc,</span><br><span class="line">        fileType: <span class="string">'image'</span>,</span><br><span class="line">        formData: &#123;</span><br><span class="line">          prefix: that.$dayjs().format(<span class="string">'YYYYMMDD'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        name: <span class="string">'file'</span>,</span><br><span class="line">        success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'uploadImage success, res is:'</span>, res);</span><br><span class="line">          <span class="keyword">const</span> &#123; code, result &#125; = <span class="built_in">JSON</span>.parse(res.data);</span><br><span class="line">          <span class="keyword">if</span> (code === <span class="number">200</span>) &#123;</span><br><span class="line">            uni.showToast(&#123;</span><br><span class="line">              title: <span class="string">'å›¾ç‰‡ä¸Šä¼ æˆåŠŸ'</span>,</span><br><span class="line">              duration: <span class="number">1000</span></span><br><span class="line">            &#125;);</span><br><span class="line">            that.form.imgs.push(result);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        fail: <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'uploadImage fail'</span>, err);</span><br><span class="line">          uni.showModal(&#123;</span><br><span class="line">            content: err.errMsg,</span><br><span class="line">            showCancel: <span class="literal">false</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    fail: <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'chooseImage fail'</span>, err);</span><br><span class="line">      <span class="comment">// #ifdef MP</span></span><br><span class="line">      uni.getSetting(&#123;</span><br><span class="line">        success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> authStatus = res.authSetting[<span class="string">'scope.album'</span>];</span><br><span class="line">          <span class="keyword">if</span> (!authStatus) &#123;</span><br><span class="line">            uni.showModal(&#123;</span><br><span class="line">              title: <span class="string">'æˆæƒå¤±è´¥'</span>,</span><br><span class="line">              content: <span class="string">'å†™å¯„è¯­éœ€è¦ä»æ‚¨çš„ç›¸å†Œè·å–å›¾ç‰‡ï¼Œè¯·åœ¨è®¾ç½®ç•Œé¢æ‰“å¼€ç›¸å…³æƒé™'</span>,</span><br><span class="line">              success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (res.confirm) &#123;</span><br><span class="line">                  uni.openSetting();</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// #endif</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åç«¯ä»£ç "><a href="#åç«¯ä»£ç " class="headerlink" title="åç«¯ä»£ç "></a>åç«¯ä»£ç </h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›¾ç‰‡ä¸Šä¼ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">'multer'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// const upload = multer(&#123; dest: '/home/assets' &#125;)</span></span><br><span class="line"><span class="keyword">var</span> storage = multer.diskStorage(&#123;</span><br><span class="line">  destination: <span class="function"><span class="keyword">function</span> (<span class="params">req, file, cb</span>) </span>&#123;</span><br><span class="line">    cb(<span class="literal">null</span>, <span class="string">'/home/assets'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  filename: <span class="function"><span class="keyword">function</span> (<span class="params">req, file, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; prefix &#125; = req.body</span><br><span class="line">    <span class="comment">// let type = file.originalname.replace(/.+\./, '.')</span></span><br><span class="line">    cb(<span class="literal">null</span>, <span class="string">`<span class="subst">$&#123;prefix&#125;</span><span class="subst">$&#123;file.originalname&#125;</span>`</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> upload = multer(&#123; <span class="attr">storage</span>: storage &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰ç«¯æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">router.post(<span class="string">'/file/upload'</span>, upload.array(<span class="string">'file'</span>, <span class="number">10</span>), <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'file:'</span>, req.files)</span><br><span class="line">  <span class="keyword">const</span> &#123; prefix &#125; = req.body</span><br><span class="line">  <span class="comment">// è·å–æ–‡ä»¶å</span></span><br><span class="line">  <span class="keyword">let</span> name = req.files[<span class="number">0</span>].originalname</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> imgUrl = <span class="string">`/<span class="subst">$&#123;prefix&#125;</span><span class="subst">$&#123;name&#125;</span>`</span></span><br><span class="line">  res.json(&#123;</span><br><span class="line">    code: <span class="number">200</span>,</span><br><span class="line">    result: imgUrl,</span><br><span class="line">    message: <span class="string">'ä¸Šä¼ æˆåŠŸ'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure><h2 id="é¢„è§ˆåœ°å€"><a href="#é¢„è§ˆåœ°å€" class="headerlink" title="é¢„è§ˆåœ°å€"></a>é¢„è§ˆåœ°å€</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip + port + /home/assets/xxx.png</span><br></pre></td></tr></table></figure><h2 id="nginx-é…ç½®"><a href="#nginx-é…ç½®" class="headerlink" title="nginx é…ç½®"></a>nginx é…ç½®</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">  <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">  <span class="attribute">server_name</span> static.xxx.com;</span><br><span class="line">  <span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">root</span> /home/assets;</span><br><span class="line">    <span class="attribute">index</span> index.html index.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">server_name</span> static.xxx.com;</span><br><span class="line">    <span class="attribute">root</span> html;</span><br><span class="line">    <span class="attribute">index</span> index.html index.htm;</span><br><span class="line">    <span class="attribute">ssl_certificate</span> /usr/local/nginx/conf/ssl/691837_static.xxx.com.pem;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /usr/local/nginx/conf/ssl/691837_static.xxx.com.key;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span> <span class="number">5m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    <span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">root</span> /home/assets;</span><br><span class="line">        <span class="attribute">index</span> index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><a href="https://github.com/chengheai/mini-write-messages">å‰ç«¯</a><br><a href="https://github.com/chengheai/mini-messages-server">nodeæœåŠ¡ç«¯</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰ç«¯ä»£ç &quot;&gt;&lt;a href=&quot;#å‰ç«¯ä»£ç &quot; class=&quot;headerlink&quot; title=&quot;å‰ç«¯ä»£ç &quot;&gt;&lt;/a&gt;å‰ç«¯ä»£ç &lt;/h2&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre
      
    
    </summary>
    
    
      <category term="node" scheme="https://github.com/chengheai/tags/node/"/>
    
      <category term="uni-app" scheme="https://github.com/chengheai/tags/uni-app/"/>
    
  </entry>
  
  <entry>
    <title>node+mongodb+vueå®ç°ä¸€ä¸ªå†™å¯„è¯­å°ç¨‹åº</title>
    <link href="https://github.com/chengheai/2021/10/25/node-mongodb-vue%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%86%99%E5%AF%84%E8%AF%AD%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    <id>https://github.com/chengheai/2021/10/25/node-mongodb-vueå®ç°ä¸€ä¸ªå†™å¯„è¯­å°ç¨‹åº/</id>
    <published>2021-10-25T13:44:06.000Z</published>
    <updated>2021-10-26T09:31:35.582Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿‘æœŸåˆ©ç”¨åä¸€çš„æ—¶å€™å†™äº†ä¸€ä¸ªå°ç¨‹åºï¼ŒæŠŠnodeã€mongodbã€nginxã€vueçš„çŸ¥è¯†ç‚¹å¤ä¹ äº†ä¸€éï¼Œä»å¼€å‘åˆ°ä¸Šçº¿æµç¨‹æ¢³ç†äº†ä¸€éï¼Œä¸‹é¢æ˜¯ä¸€äº›æ¶‰åŠåˆ°çš„æ˜“é”™æ­¥éª¤<br>1ã€<a href="https://blog.stack021.cn/2021/10/25/å¦‚ä½•ä½¿ç”¨multerå®ç°æ–‡ä»¶ä¸Šä¼ åŠå›æ˜¾/" target="_blank" rel="noopener">å¦‚ä½•ä½¿ç”¨multerå®ç°æ–‡ä»¶ä¸Šä¼ åŠå›æ˜¾</a><br>2ã€<a href="https://blog.stack021.cn/2021/10/25/serverå¦‚ä½•å®ç°ç™»å½•ç”ŸæˆtokenåŠæ¥å£æ ¡éªŒtoken/" target="_blank" rel="noopener">node serverå¦‚ä½•å®ç°ç™»å½•ç”ŸæˆtokenåŠæ¥å£æ ¡éªŒtoken</a><br>3ã€<a href="https://blog.stack021.cn/2021/10/25/mongooseæ“ä½œæ•°æ®/" target="_blank" rel="noopener">mongooseæ“ä½œæ•°æ®</a><br>4ã€<a href="https://blog.stack021.cn/2021/10/25/serverå¦‚ä½•å®ç°ç™»å½•ç”ŸæˆtokenåŠæ¥å£æ ¡éªŒtoken/" target="_blank" rel="noopener">centos7 å®‰è£…mongodbã€pm2ç­‰</a><br>5ã€<a href="https://blog.stack021.cn/2021/10/25/httpè½¬https/" target="_blank" rel="noopener">nginx httpè½¬https</a><br>6ã€<a href="https://blog.stack021.cn//2021/10/26/nodejsæœåŠ¡è·å–å¾®ä¿¡ç”¨æˆ·openid/" target="_blank" rel="noopener">nodejsæœåŠ¡è·å–å¾®ä¿¡ç”¨æˆ·openid</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><a href="https://github.com/chengheai/mini-write-messages">å‰ç«¯</a><br><a href="https://github.com/chengheai/mini-messages-server">nodeæœåŠ¡ç«¯</a></p><h2 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><p><img src="https://github.com/chengheai/review-demo-image/blob/master/mini.jpg?raw=true" alt="å°ç¨‹åºç " width="300" height="300" align="center"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è¿‘æœŸåˆ©ç”¨åä¸€çš„æ—¶å€™å†™äº†ä¸€ä¸ªå°ç¨‹åºï¼ŒæŠŠnodeã€mongodbã€nginxã€vueçš„çŸ¥è¯†ç‚¹å¤ä¹ äº†ä¸€éï¼Œä»å¼€å‘åˆ°ä¸Šçº¿æµç¨‹æ¢³ç†äº†ä¸€éï¼Œä¸‹é¢æ˜¯ä¸€äº›æ¶‰
      
    
    </summary>
    
    
      <category term="vue" scheme="https://github.com/chengheai/tags/vue/"/>
    
      <category term="mongodb" scheme="https://github.com/chengheai/tags/mongodb/"/>
    
      <category term="node" scheme="https://github.com/chengheai/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£jsä¸­é˜²æŠ–è·Ÿæˆªæµçš„åŒºåˆ«</title>
    <link href="https://github.com/chengheai/2021/07/15/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3js%E4%B8%AD%E9%98%B2%E6%8A%96%E8%B7%9F%E6%88%AA%E6%B5%81%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>https://github.com/chengheai/2021/07/15/æ·±å…¥ç†è§£jsä¸­é˜²æŠ–è·Ÿæˆªæµçš„åŒºåˆ«/</id>
    <published>2021-07-15T13:29:55.000Z</published>
    <updated>2021-10-20T14:10:38.984Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨æ—¥å¸¸é¡¹ç›®å¼€å‘ä¸­ï¼Œé€šå¸¸ä¼šç¢°åˆ°ç›‘å¬å¤„ç†çš„æ“ä½œï¼Œæ¯”å¦‚ç›‘å¬æµè§ˆå™¨çª—å£å¤§å°æ”¹å˜ï¼Œç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œç›‘å¬è¾“å…¥äº‹ä»¶ç­‰ç­‰ï¼Œç„¶è€Œåšè¿™æ–¹é¢åŠŸèƒ½çš„æ—¶å€™å°±è¦æƒ³ç€æ€ä¹ˆä¼˜åŒ–æ€§èƒ½ï¼Œé˜²æŠ–è·Ÿæˆªæµå°±æ´¾ä¸Šç”¨åœºäº†</p><h2 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h2><blockquote><p>è§¦å‘é«˜é¢‘äº‹ä»¶ådelayå†…å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœdelayå†…é«˜é¢‘äº‹ä»¶å†æ¬¡è¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡ç®—æ—¶é—´</p></blockquote><ol><li>å®ç°æ–¹å¼ï¼šæ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶è®¾ç½®ä¸€ä¸ªå»¶è¿Ÿè°ƒç”¨æ–¹æ³•ï¼Œå¹¶ä¸”å–æ¶ˆä¹‹å‰çš„å»¶æ—¶è°ƒç”¨æ–¹æ³•</li><li>ç¼ºç‚¹ï¼šå¦‚æœäº‹ä»¶åœ¨è§„å®šçš„æ—¶é—´é—´éš”å†…è¢«ä¸æ–­çš„è§¦å‘ï¼Œåˆ™è°ƒç”¨æ–¹æ³•ä¼šè¢«ä¸æ–­çš„å»¶è¿Ÿ</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//debounce</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">method, delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">      clearTimeout(timer)</span><br><span class="line">      timer = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      method.apply(self, <span class="built_in">arguments</span>)</span><br><span class="line">    &#125;, delay)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(xxx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ»šåŠ¨äº‹ä»¶</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, debounce(handle,<span class="number">1000</span>));</span><br></pre></td></tr></table></figure><h1 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h1><blockquote><p>æŒ‡åœ¨è§„å®šæ—¶é—´å†…åªè§¦å‘ä¸€æ¬¡äº‹ä»¶ï¼Œå‡å°‘äº‹ä»¶æ‰§è¡Œçš„é¢‘ç‡</p></blockquote><ol><li>å®ç°æ–¹å¼ï¼šæ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶ï¼Œå¦‚æœå½“å‰æœ‰ç­‰å¾…æ‰§è¡Œçš„å»¶æ—¶å‡½æ•°ï¼Œåˆ™ç›´æ¥return</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn,delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> canRun = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">if</span> (!canRun) <span class="keyword">return</span></span><br><span class="line">    canRun = <span class="literal">false</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      fn.apply(self, <span class="built_in">arguments</span>)</span><br><span class="line">      canRun = <span class="literal">true</span></span><br><span class="line">    &#125;, delay)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…¶ä»–ç‰ˆæœ¬"><a href="#å…¶ä»–ç‰ˆæœ¬" class="headerlink" title="å…¶ä»–ç‰ˆæœ¬"></a>å…¶ä»–ç‰ˆæœ¬</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ—¶é—´æˆ³</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle1</span> (<span class="params">fn, delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> prev = <span class="built_in">Date</span>.now()</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> now = <span class="built_in">Date</span>.now()</span><br><span class="line">    <span class="keyword">if</span> (now - prev &gt;= delay) &#123;</span><br><span class="line">      fn()</span><br><span class="line">      prev = <span class="built_in">Date</span>.now()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šæ—¶å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle2</span> (<span class="params">fn, delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">      timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        fn()</span><br><span class="line">        timer = <span class="literal">null</span></span><br><span class="line">      &#125;, delay)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h1><p><a href="https://chengheai.github.io/daily-vue-demo/#/throttle" target="_blank" rel="noopener">throttle æˆªæµ</a><br><a href="https://chengheai.github.io/daily-vue-demo/#/debounce" target="_blank" rel="noopener">debounce é˜²æŠ–</a></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¸€èˆ¬æƒ…å†µä¸‹onresizeï¼Œonkeyupäº‹ä»¶ä½¿ç”¨é˜²æŠ–ï¼›onscrollã€onmousemoveç­‰äº‹ä»¶ä½¿ç”¨æˆªæµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨æ—¥å¸¸é¡¹ç›®å¼€å‘ä¸­ï¼Œé€šå¸¸ä¼šç¢°åˆ°ç›‘å¬å¤„ç†çš„æ“ä½œï¼Œæ¯”å¦‚ç›‘å¬æµè§ˆå™¨çª—å£å¤§å°æ”¹å˜ï¼Œç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œç›‘å¬è¾“å…¥äº‹ä»¶ç­‰ç­‰ï¼Œç„¶è€Œåšè¿™æ–¹é¢åŠŸèƒ½çš„æ—¶å€™å°±è¦æƒ³ç€æ€ä¹ˆä¼˜
      
    
    </summary>
    
    
      <category term="Javascript" scheme="https://github.com/chengheai/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>jenkins+docker+github+nginxå‰ç«¯å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²</title>
    <link href="https://github.com/chengheai/2020/07/06/jenkins-docker-github-nginx%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/"/>
    <id>https://github.com/chengheai/2020/07/06/jenkins-docker-github-nginxå‰ç«¯å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²/</id>
    <published>2020-07-06T14:08:22.000Z</published>
    <updated>2021-10-20T14:10:38.965Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç”±äºä¹‹å‰å†™è¿‡react+nodejs+mongodbçš„é¡¹ç›®ï¼Œåªæ˜¯åœ¨æœ¬åœ°å¼€å‘å®Œæˆï¼Œæƒ³å°è¯•æ­£å¸¸å¼€å‘éƒ¨ç½²ä¸Šçº¿æµå‡ºèµ°ä¸€æ³¢ï¼Œç„¶è€Œåœ¨ç½‘ä¸Šæœç´¢ä¸€ç•ªï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å†™çš„åŸºç¡€ä¸œè¥¿ï¼Œæ ‡é¢˜å¤§å†…å®¹å°ï¼Œæœ‰çš„ç”šè‡³å†™åˆ°å…³é”®ä½ç½®å°±æ²¡äº†ï¼Œå½“ç„¶ä¹Ÿæœ‰äº›æ˜¯å¥½æ–‡ç« ï¼Œä¸‹é¢æ˜¯æˆ‘æ€»ç»“ä¸€äº›é—®é¢˜ï¼Œè¸©è¿‡å‘ä¹‹åçš„æµç¨‹</p><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><ul><li>è™šæ‹Ÿæœºä¸€å°ï¼Œå¸‚é¢ä¸Šçš„æœ‰VirtualBoxã€macã€‘ï¼ŒVMwareã€windowsã€‘ç³»ç»Ÿä¸ºlinuxï¼Œç¬”è€…ä¸ºlinux CentOS7.6<h2 id="Dockerå®‰è£…"><a href="#Dockerå®‰è£…" class="headerlink" title="Dockerå®‰è£…"></a>Dockerå®‰è£…</h2></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çœ‹ä½ å½“å‰çš„å†…æ ¸ç‰ˆæœ¬</span></span><br><span class="line">uname -r</span><br><span class="line"></span><br><span class="line"><span class="comment">// yum åŒ…æ›´æ–°åˆ°æœ€æ–°</span></span><br><span class="line">yum update -y</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®‰è£… docker</span></span><br><span class="line">yum install docker</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨å¹¶åŠ å…¥å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl enable docker</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹è½½docker-compose</span></span><br><span class="line">curl -L https:<span class="comment">//github.com/docker/compose/releases/download/1.23.2/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ å¯æ‰§è¡Œæƒé™(è¿™é‡Œä¸æ‡‚å¯ä»¥çœ‹ä¸€ä¸‹èœé¸Ÿæ•™ç¨‹-linuxæ•™ç¨‹-æ–‡ä»¶æƒé™)</span></span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br><span class="line"><span class="comment">// æŸ¥çœ‹docker-composeç‰ˆæœ¬</span></span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure><h2 id="Jenkins-å®‰è£…ä¸é…ç½®"><a href="#Jenkins-å®‰è£…ä¸é…ç½®" class="headerlink" title="Jenkins å®‰è£…ä¸é…ç½®"></a>Jenkins å®‰è£…ä¸é…ç½®</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search jenkins</span><br></pre></td></tr></table></figure><p>é€‰æ‹©ç¬¬äºŒä¸ªæˆ–è€…ç¬¬ä¸‰ä¸ªï¼Œç¬¬ä¸€ä¸ªæœ‰å‘</p><h3 id="å®‰è£…jenkins"><a href="#å®‰è£…jenkins" class="headerlink" title="å®‰è£…jenkins"></a>å®‰è£…jenkins</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -u <span class="number">0</span> --privileged --name jenkins -p <span class="number">8888</span>:<span class="number">8080</span> -v /root/jenkins_home:<span class="regexp">/var/</span>jenkins_home jenkins/jenkins</span><br></pre></td></tr></table></figure><p>æ³¨æ„âš ï¸ï¼šæœ¬æœºéœ€è¦åœ¨/rootä¸‹åˆ›å»ºä¸€ä¸ªjenkins_homeæ–‡ä»¶å¤¹ã€æ²¡æœ‰å°±åŠ ï¼Œæœ‰å°±è¦åŠ ã€‘<br>å…¶ä¸­:<br>-d æŒ‡çš„æ˜¯åœ¨åå°è¿è¡Œï¼›<br>-u 0 æŒ‡çš„æ˜¯ä¼ å…¥ root è´¦å· IDï¼Œè¦†ç›–å®¹å™¨ä¸­å†…ç½®çš„è´¦å·ï¼›<br>-v /root/jenkins_home:/var/jenkins_home æŒ‡çš„æ˜¯å°† docker å®¹å™¨å†…çš„ç›®å½• /var/jenkins_home æ˜ å°„åˆ°å®¿ä¸»æœº /root/jenkins_home ç›®å½•ä¸Šï¼›<br>â€“name jenkins æŒ‡çš„æ˜¯å°† docker å®¹å™¨å†…çš„ç›®å½• /var/jenkins_home æ˜ å°„åˆ°å®¿ä¸»æœº /root/jenkins_home ç›®å½•ä¸Šï¼›<br>-p 49003:8080 æŒ‡çš„æ˜¯å°†å®¹å™¨çš„ 8080 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 8888 ç«¯å£ï¼›<br>â€“privileged æŒ‡çš„æ˜¯èµ‹äºˆæœ€é«˜æƒé™ã€‚</p><p>æ•´æ¡å‘½ä»¤çš„æ„æ€å°±æ˜¯ï¼š<br>è¿è¡Œä¸€ä¸ªé•œåƒä¸º jenkins/jenkins:latest çš„å®¹å™¨ï¼Œå‘½åä¸º jenkins_homeï¼Œä½¿ç”¨ root è´¦å·è¦†ç›–å®¹å™¨ä¸­çš„è´¦å·ï¼Œèµ‹äºˆæœ€é«˜æƒé™ï¼Œå°†å®¹å™¨çš„ /var/jenkins_home æ˜ å°„åˆ°å®¿ä¸»æœºçš„ /root/jenkins_home ç›®å½•ä¸‹ï¼Œæ˜ å°„å®¹å™¨ä¸­ 8080 ç«¯å£åˆ°å®¿ä¸»æœº 49003 ç«¯å£</p><p>æ‰§è¡Œå®Œæˆåï¼Œç­‰å¾…å‡ åç§’ï¼Œç­‰å¾… Jenkins å®¹å™¨å¯åŠ¨åˆå§‹åŒ–ã€‚åˆ°æµè§ˆå™¨ä¸­è¾“å…¥ <a href="http://your" target="_blank" rel="noopener">http://your</a> ip:49003 æŸ¥çœ‹ Jenkins æ˜¯å¦å¯åŠ¨æˆåŠŸ</p><p>çœ‹åˆ°å¦‚ä¸‹ç•Œé¢è¯´æ˜å¯åŠ¨æˆåŠŸï¼š</p><p>é€šè¿‡å¦‚ä¸‹å‘½ä»¤è·å–å¯†ç ï¼Œå¤åˆ¶åˆ°ä¸Šå›¾è¾“å…¥æ¡†ä¸­</p><p>è¿›å…¥åˆ°ä¸‹ä¸ªé¡µé¢ï¼Œé€‰æ‹©ã€å®‰è£…æ¨èçš„æ’ä»¶ã€‘ã€‚</p><p>ç”±äºå¢™çš„é—®é¢˜ï¼Œéœ€è¦ä¿®æ”¹ Jenkins çš„é»˜è®¤ä¸‹è½½åœ°å€ã€‚å¯ä»¥åœ¨æµè§ˆå™¨å¦èµ·ä¸€ä¸ª tab é¡µé¢ï¼Œè¿›å…¥ <a href="http://your" target="_blank" rel="noopener">http://your</a> ip:49003/pluginManager/advancedï¼Œä¿®æ”¹æœ€ä¸‹é¢çš„å‡çº§ç«™ç‚¹ URL ä¸º <a href="http://mirror.esuni.jp/jenkins/updates/update-center.json" target="_blank" rel="noopener">http://mirror.esuni.jp/jenkins/updates/update-center.json</a></p><p>ç„¶åé‡å¯å®¹å™¨ï¼Œå†æ¬¡è¿›å…¥åˆå§‹åŒ–é¡µé¢ï¼Œé€šå¸¸ä¸‹è½½é€Ÿåº¦ä¼šåŠ å¿«ã€‚</p><p>ç„¶åå°±æ˜¯åˆ›å»ºç®¡ç†å‘˜è´¦å·ã€‚</p><p>è¿›å…¥é¦–é¡µåï¼Œå› ä¸ºè‡ªåŠ¨åŒ–éƒ¨ç½²ä¸­éœ€è¦é€šè¿‡ ssh ç™»é™†æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤ä»¥åŠ node ç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ä¸‹è½½ Publish Over SSH å’Œ NodeJS æ’ä»¶ï¼Œå¯é€šè¿‡ç³»ç»Ÿç®¡ç† -&gt; ç®¡ç†æ’ä»¶ -&gt; å¯é€‰æ’ä»¶è¿›å…¥ï¼Œæœç´¢é€‰ä¸­å¹¶ç›´æ¥å®‰è£…ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPublish Over SSH éœ€è¦é…ç½®ç›¸å…³ ssh æœåŠ¡å™¨ï¼Œé€šè¿‡ç³»ç»Ÿç®¡ç† -&gt; ç³»ç»Ÿè®¾ç½® è¿›å…¥å¹¶æ‹‰åˆ°æœ€ä¸‹é¢ï¼Œè¾“å…¥ Nameã€Hostnameã€Usernameã€Passphrase / Password ç­‰å‚æ•°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>ç„¶åç‚¹å‡» Test Configuration æ ¡éªŒèƒ½å¦ç™»é™†ã€‚</p><p>è‡³æ­¤ Jenkins å·²ç»å®Œæˆäº†å…¨å±€é…ç½®ã€‚</p><p>å…³è” Jenkins å’Œ Github<br>åœ¨ GitHub åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä»¥æœ¬é¡¹ç›®ä¸ºä¾‹ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º nginx.conf å’Œ docker-compose.yml æ–‡ä»¶</p><p>nginx.conf<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user  nobody;</span></span><br><span class="line">worker_processes 1;</span><br><span class="line"></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">  include mime.types;</span><br><span class="line">  default_type application/octet-stream;</span><br><span class="line"></span><br><span class="line">  <span class="comment">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">  <span class="comment">#                  '$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">  <span class="comment">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#access_log  logs/access.log  main;</span></span><br><span class="line"></span><br><span class="line">  sendfile on;</span><br><span class="line">  <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">  keepalive_timeout 65;</span><br><span class="line"></span><br><span class="line">  <span class="comment">#gzip  on;</span></span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line">    listen 10000;</span><br><span class="line">    server_name 192.168.56.101;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#access_log  logs/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">      index index.html index.htm;</span><br><span class="line">      root /usr/share/nginx/html;</span><br><span class="line">      <span class="comment"># æ‰€æœ‰é™æ€èµ„æºå‡æŒ‡å‘ /index.html</span></span><br><span class="line">      try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    error_page 500 502 503 504 /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">      root  /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># location /api &#123;</span></span><br><span class="line">    <span class="comment">#   proxy_pass http://server:port;</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    root           html;</span></span><br><span class="line">    <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">    <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">    <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">    <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># deny access to .htaccess files, if Apache's document root</span></span><br><span class="line">    <span class="comment"># concurs with nginx's one</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">    <span class="comment">#    deny  all;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>docker-compose.yml</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">'3'</span></span><br><span class="line">services:</span><br><span class="line">  ad-tpl-vue: <span class="comment">#é¡¹ç›®name</span></span><br><span class="line">    container_name: <span class="string">'webhtml'</span> <span class="comment">#å®¹å™¨åç§°</span></span><br><span class="line">    image: nginx</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - 10000:10000</span><br><span class="line">    volumes:</span><br><span class="line">      - ./nginx.conf:/etc/nginx/nginx.conf <span class="comment">#æŒ‚è½½nginxé…ç½®</span></span><br><span class="line">      - ./dist:/usr/share/nginx/html/ <span class="comment">#æŒ‚è½½é¡¹ç›®</span></span><br><span class="line">    privileged: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦è§£é‡Šä¸‹ volumes å‚æ•°ï¼Œåœ¨æ‰“åŒ… Docker é•œåƒæ—¶ï¼Œå¦‚æœå°† nginx.conf å’Œ dist ç›´æ¥æ‹·è´åˆ°é•œåƒä¸­ï¼Œé‚£ä¹ˆæ¯æ¬¡ä¿®æ”¹ç›¸å…³æ–‡ä»¶æ—¶ï¼Œéƒ½éœ€è¦é‡æ–°æ‰“åŒ…æ–°çš„é•œåƒã€‚é€šè¿‡ volumes å¯ä»¥å°†å®¿ä¸»æœºçš„æŸä¸ªæ–‡ä»¶æ˜ å°„åˆ°å®¹å™¨çš„æŸä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆæ”¹åŠ¨ç›¸å…³æ–‡ä»¶ï¼Œå°±ä¸è¦é‡æ–°æ‰“åŒ…é•œåƒäº†ï¼Œåªéœ€ä¿®æ”¹å®¿ä¸»æœºä¸Šçš„æ–‡ä»¶å³å¯ã€‚</p><p>ç„¶ååœ¨ Jenkins åˆ›å»ºä¸€ä¸ªæ–°çš„ä»»åŠ¡ï¼Œé€‰æ‹©ã€æ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®ã€‘ï¼Œå¹¶è®¾ç½®ç›¸å…³é…ç½®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p>å…¶ä¸­ç¬¬ä¸‰å¼ å›¾ä¸¤éƒ¨åˆ†å‘½ä»¤å«ä¹‰å¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€éƒ¨åˆ† shell å‘½ä»¤æ˜¯ build å‰ç«¯é¡¹ç›®ï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ dist ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br><span class="line">npm install</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ† shell å‘½ä»¤å°±æ˜¯é€šè¿‡ ssh ç™»é™†æœåŠ¡å™¨ï¼Œé€šè¿‡ docker-compose è¿›è¡Œæ„å»º docker é•œåƒå¹¶è¿è¡Œå®¹å™¨ã€‚ç›¸è¾ƒäºç›´æ¥ä½¿ç”¨ docker ï¼Œå½“æ›´æ–°ä»£ç æ—¶æ— éœ€æ‰§è¡Œåœæ­¢åˆ é™¤å®¹å™¨ï¼Œé‡æ–°æ„å»ºæ–°çš„é•œåƒç­‰æ“ä½œã€‚<br>cd /root/jenkins_home/workspace/ad-tpl-vue \<br>&amp;&amp; docker-compose stop &amp;&amp; docker-compose up -d</p><p>æœ€åå¯ä»¥å›åˆ°è¯¥ä»»åŠ¡é¡µï¼Œç‚¹å‡»ã€ç«‹å³æ„å»ºã€‘æ¥æ„å»ºæˆ‘ä»¬çš„é¡¹ç›®äº†ã€‚<br>å®ç°è‡ªåŠ¨è§¦å‘æ‰“åŒ…<br>ä¸è¿‡ä»æœ‰ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å½“å‘ GitHub è¿œç¨‹ä»“åº“ push ä»£ç æ—¶ï¼Œéœ€è¦èƒ½å¤Ÿè‡ªåŠ¨è§¦å‘æ„å»ºï¼Œç›¸å…³æ“ä½œå¦‚ä¸‹ã€‚<br>1.ä¿®æ”¹ Jenkins å®‰å…¨ç­–ç•¥</p><p>é€šè¿‡ç³»ç»Ÿç®¡ç† -&gt; å…¨å±€å®‰å…¨é…ç½® è¿›å…¥ï¼Œå¹¶å¦‚ä¸‹å›¾æ“ä½œ</p><p>2.ç”Ÿæˆ Jenkins API Token</p><p>é€šè¿‡ç”¨æˆ·åˆ—è¡¨ -&gt; ç‚¹å‡»ç®¡ç†å‘˜ç”¨æˆ· -&gt; è®¾ç½®ï¼Œç‚¹å‡»æ·»åŠ æ–° tokenï¼Œç„¶åå¤åˆ¶èº«ä»½éªŒè¯ä»¤ç‰Œ token</p><p>3.åœ¨ Jenkins é¡¹ç›®å¯¹åº”ä»»åŠ¡çš„è®¾ç½®ä¸­é…ç½®ã€æ„å»ºè§¦å‘å™¨ã€‘ï¼Œå°†åˆšå¤åˆ¶çš„ token ç²˜è´´è¿›å»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>4.åœ¨ Github ç›¸å…³é¡¹ç›®ä¸­æ‰“å¼€ Setting -&gt; Webhooks -&gt; Add webhooksï¼Œè¾“å…¥æ ¼å¼å¦‚ä¸‹çš„ URL :<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‰é¢æ˜¯ Jenkins æœåŠ¡åœ°å€ï¼Œad-tpl-vue æŒ‡åœ¨ Jenkins çš„ä»»åŠ¡åç§°ï¼ŒTokenæŒ‡ä¸Šé¢è·å–çš„ä»¤ç‰Œ</span></span><br><span class="line">http:<span class="comment">//12x.xxx.xxx.xxx:xxxx/job/ad-tpl-vue/build?token=Token</span></span><br></pre></td></tr></table></figure></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº†åœ¨ push æ–°çš„ä»£ç åï¼Œè‡ªåŠ¨è§¦å‘ Jenkins æ‰“åŒ…é¡¹ç›®ä»£ç ï¼Œå¹¶æ‰“åŒ… docker é•œåƒç„¶åè¿è¡Œã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç”±äºä¹‹å‰å†™è¿‡react+nodejs+mongodbçš„é¡¹ç›®ï¼Œåªæ˜¯åœ¨æœ¬åœ°å¼€å‘å®Œæˆï¼Œæƒ³å°è¯•æ­£å¸¸å¼€å‘éƒ¨ç½²ä¸Šçº¿æµå‡ºèµ°ä¸€æ³¢ï¼Œç„¶è€Œåœ¨ç½‘ä¸Šæœç´¢ä¸€ç•ªï¼Œå¤§éƒ¨åˆ†
      
    
    </summary>
    
    
      <category term="nginx" scheme="https://github.com/chengheai/tags/nginx/"/>
    
      <category term="docker" scheme="https://github.com/chengheai/tags/docker/"/>
    
      <category term="jenkins" scheme="https://github.com/chengheai/tags/jenkins/"/>
    
  </entry>
  
  <entry>
    <title>el-date-picker daterangeè®¾ç½®ä¸Šä¸‹7å¤©é€‰æ‹©åŒºé—´</title>
    <link href="https://github.com/chengheai/2020/06/11/daterange%E8%AE%BE%E7%BD%AE%E4%B8%8A%E4%B8%8B7%E5%A4%A9%E9%80%89%E6%8B%A9%E5%8C%BA%E9%97%B4/"/>
    <id>https://github.com/chengheai/2020/06/11/daterangeè®¾ç½®ä¸Šä¸‹7å¤©é€‰æ‹©åŒºé—´/</id>
    <published>2020-06-11T06:18:25.000Z</published>
    <updated>2021-10-20T14:10:38.963Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>æ—¶é—´é€‰æ‹©åŒºé—´æƒ³ä¸ªä¸èƒ½è¶…è¿‡ 7 å¤©</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"æœç´¢æ—¶é—´:"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-date-picker</span></span></span><br><span class="line"><span class="tag"><span class="attr">v-model</span>=<span class="string">"form.rangeDate"</span></span></span><br><span class="line"><span class="tag"><span class="attr">value-format</span>=<span class="string">"yyyy-MM-dd"</span></span></span><br><span class="line"><span class="tag"><span class="attr">type</span>=<span class="string">"daterange"</span></span></span><br><span class="line"><span class="tag"><span class="attr">:picker-options</span>=<span class="string">"pickerOptions"</span></span></span><br><span class="line"><span class="tag"><span class="attr">clearable</span></span></span><br><span class="line"><span class="tag">@<span class="attr">change</span>=<span class="string">"handleFormChange"</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data()&#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span> <span class="comment">// å…³é”®</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    pickerOptions: &#123;</span><br><span class="line">      disabledDate(time) &#123;</span><br><span class="line">        <span class="keyword">let</span> timeOptionRange = that.timeOptionRange</span><br><span class="line">        <span class="keyword">let</span> secondNum = <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span> * <span class="number">1000</span></span><br><span class="line">        <span class="keyword">if</span> (timeOptionRange) &#123;</span><br><span class="line">          <span class="keyword">return</span> time.getTime() &gt; timeOptionRange.getTime() + secondNum || time.getTime() &lt; timeOptionRange.getTime() - secondNum</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, onPick(time) &#123;</span><br><span class="line">        <span class="comment">// å½“ç¬¬ä¸€æ—¶é—´é€‰ä¸­æ‰è®¾ç½®ç¦ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> (time.minDate &amp;&amp; !time.maxDate) &#123;</span><br><span class="line">          that.timeOptionRange = time.minDate</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (time.maxDate) &#123;</span><br><span class="line">          that.timeOptionRange = <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;éœ€æ±‚&quot;&gt;&lt;a href=&quot;#éœ€æ±‚&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚&quot;&gt;&lt;/a&gt;éœ€æ±‚&lt;/h2&gt;&lt;p&gt;æ—¶é—´é€‰æ‹©åŒºé—´æƒ³ä¸ªä¸èƒ½è¶…è¿‡ 7 å¤©&lt;/p&gt;
&lt;h2 id=&quot;ä»£ç &quot;&gt;&lt;a href=&quot;#ä»£ç &quot; class=&quot;headerlink&quot; titl
      
    
    </summary>
    
    
      <category term="element-ui" scheme="https://github.com/chengheai/tags/element-ui/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³vueä¸­ç§»åŠ¨ç«¯iosé”®ç›˜æ”¶èµ·é¡µé¢ä¸å½’ä½é—®é¢˜</title>
    <link href="https://github.com/chengheai/2020/03/24/%E8%A7%A3%E5%86%B3vue%E4%B8%AD%E7%A7%BB%E5%8A%A8%E7%AB%AFios%E9%94%AE%E7%9B%98%E6%94%B6%E8%B5%B7%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%BD%92%E4%BD%8D%E9%97%AE%E9%A2%98/"/>
    <id>https://github.com/chengheai/2020/03/24/è§£å†³vueä¸­ç§»åŠ¨ç«¯iosé”®ç›˜æ”¶èµ·é¡µé¢ä¸å½’ä½é—®é¢˜/</id>
    <published>2020-03-24T12:36:07.000Z</published>
    <updated>2021-10-20T14:10:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç½‘ä¸Šæ‰¾çš„ä¾‹å­<br>åƒç¯‡ä¸€å¾‹ï½ï½ï½ï½ï½<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://github.com/chengheai/review-demo-image/blob/master/WX20200324-204643@2x.png?raw=true" alt title>                </div>                <div class="image-caption"></div>            </figure></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> @<span class="attr">focusout</span>=<span class="string">"inputBlur"</span> @<span class="attr">focusin</span>=<span class="string">"inputFocus"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"tel"</span> <span class="attr">placeholder</span>=<span class="string">"è¯·è¾“å…¥æ‰‹æœºå·"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">placeholder</span>=<span class="string">"è¯·è¾“å…¥éªŒè¯ç "</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    data() &#123;</span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">        timer: <span class="literal">null</span>,</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      inputBlur(e) &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (e &amp;&amp; e.target &amp;&amp; e.target.tagName &amp;&amp; e.target.tagName.toLowerCase() === <span class="string">'input'</span>) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, <span class="number">0</span>);</span></span><br><span class="line">          &#125;, 0);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      inputFocus(e) &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (e &amp;&amp; e.target &amp;&amp; e.target.tagName &amp;&amp; e.target.tagName.toLowerCase() === <span class="string">'input'</span>) &#123;</span></span><br><span class="line"><span class="javascript">          clearTimeout(<span class="keyword">this</span>.timer);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"scss"</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç½‘ä¸Šæ‰¾çš„ä¾‹å­&lt;br&gt;åƒç¯‡ä¸€å¾‹ï½ï½ï½ï½ï½&lt;br&gt;&lt;figure class=&quot;image-bubble&quot;&gt;
                &lt;
      
    
    </summary>
    
    
      <category term="vue" scheme="https://github.com/chengheai/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>el-time-pickerè‡ªå®šä¹‰é€‰æ‹©å¤§äºå½“å‰æ—¶é—´é™åˆ¶</title>
    <link href="https://github.com/chengheai/2020/03/11/el-time-picker%E8%87%AA%E5%AE%9A%E4%B9%89%E9%80%89%E6%8B%A9%E5%A4%A7%E4%BA%8E%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E9%99%90%E5%88%B6/"/>
    <id>https://github.com/chengheai/2020/03/11/el-time-pickerè‡ªå®šä¹‰é€‰æ‹©å¤§äºå½“å‰æ—¶é—´é™åˆ¶/</id>
    <published>2020-03-11T13:02:59.000Z</published>
    <updated>2021-10-20T14:10:38.964Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>something think</p><h2 id="DEMO"><a href="#DEMO" class="headerlink" title="DEMO"></a>DEMO</h2><p><a href="https://chengheai.github.io/daily-vue-demo/#/date-picker" target="_blank" rel="noopener">åœ¨çº¿ demoğŸ±ğŸ¤“ğŸ‘€</a></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:model</span>=<span class="string">"ruleForm"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:rules</span>=<span class="string">"rules"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">"ruleForm"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">label-width</span>=<span class="string">"150px"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"demo-ruleForm"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"å¤§äºå½“å‰æ—¶é—´"</span> <span class="attr">prop</span>=<span class="string">"mytime"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-date-picker</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"datetime"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">"é€‰æ‹©æ—¥æœŸ"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">value-format</span>=<span class="string">"timestamp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:picker-options</span>=<span class="string">"pickerOptions"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"ruleForm.mytime"</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">el-date-picker</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"submitForm('ruleForm')"</span>&gt;</span>ç«‹å³åˆ›å»º<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"resetForm('ruleForm')"</span>&gt;</span>é‡ç½®<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      <span class="keyword">var</span> validateTime = <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (value &lt;= <span class="built_in">Date</span>.now()) &#123;</span><br><span class="line">          callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'é€‰æ‹©æ—¶é—´å¿…é¡»å¤§äºå½“å‰æ—¶é—´'</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          callback();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        pickerOptions: &#123;</span><br><span class="line">          <span class="comment">// é™åˆ¶æ”¶è´§æ—¶é—´ä¸è®©é€‰æ‹©ä»Šå¤©ä»¥å‰çš„</span></span><br><span class="line">          disabledDate(time) &#123;</span><br><span class="line">            <span class="keyword">return</span> time.getTime() &lt; <span class="built_in">Date</span>.now() - <span class="number">8.64e7</span>;</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        ruleForm: &#123;</span><br><span class="line">          mytime: <span class="string">''</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        rules: &#123;</span><br><span class="line">          mytime: [</span><br><span class="line">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'è¯·é€‰æ‹©æ—¶é—´'</span>, <span class="attr">trigger</span>: <span class="string">'change'</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">validator</span>: validateTime, <span class="attr">trigger</span>: <span class="string">'blur'</span> &#125;,</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      submitForm(formName) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$refs[formName].validate(<span class="function"><span class="params">valid</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">            alert(<span class="string">'submit!'</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'error submit!!'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      resetForm(formName) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$refs[formName].resetFields();</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h2&gt;&lt;p&gt;something think&lt;/p&gt;
&lt;h2 id=&quot;DEMO&quot;&gt;&lt;a href=&quot;#DEMO&quot; class=&quot;headerlink&quot; t
      
    
    </summary>
    
    
      <category term="element-ui" scheme="https://github.com/chengheai/tags/element-ui/"/>
    
  </entry>
  
  <entry>
    <title>åŸç”Ÿjså®ç°reduxä¸­getState,subscribe,listener,dispatchå‡½æ•°</title>
    <link href="https://github.com/chengheai/2020/03/01/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0redux%E4%B8%ADgetState-subscribe-listener-dispatch%E5%87%BD%E6%95%B0/"/>
    <id>https://github.com/chengheai/2020/03/01/åŸç”Ÿjså®ç°reduxä¸­getState-subscribe-listener-dispatchå‡½æ•°/</id>
    <published>2020-03-01T12:05:52.000Z</published>
    <updated>2021-10-20T14:10:38.981Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸç”Ÿä»£ç "><a href="#åŸç”Ÿä»£ç " class="headerlink" title="åŸç”Ÿä»£ç "></a>åŸç”Ÿä»£ç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- åŸç”Ÿjså®ç°dispatch å‡½æ•° --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span>å†…å®¹<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> render = <span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'title'</span>).innerHTML = state.title;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'content'</span>).innerHTML = state.content;</span></span><br><span class="line">      &#125;;</span><br><span class="line"><span class="javascript">      <span class="comment">// è‡ªå®šä¹‰ä¸€ä¸ªdispatchè¿‡ç¨‹</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> appReducer = <span class="function"><span class="keyword">function</span>(<span class="params">state, action</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// è¿”å›é»˜è®¤çš„state</span></span></span><br><span class="line">        if (!state) &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">            title: <span class="string">'åˆå§‹åŒ–title'</span>,</span></span><br><span class="line"><span class="javascript">            content: <span class="string">'åˆå§‹åŒ–content'</span>,</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="comment">//è¿”å›ç›¸åº”çš„state</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">switch</span> (action.type) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">case</span> <span class="string">'CHANGE_TITLE'</span>:</span></span><br><span class="line"><span class="javascript">            <span class="comment">// stateä¿®æ”¹</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line">              ...state,</span><br><span class="line">              title: action.newTitle,</span><br><span class="line">            &#125;;</span><br><span class="line"><span class="javascript">          <span class="keyword">default</span>:</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> state;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"><span class="javascript">      <span class="comment">// å¸Œæœ›è°ƒç”¨createStoreå°±è¿”å›ä¸€ä¸ªstore</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// çº¯å‡½æ•° ä¼ å…¥ä»€ä¹ˆè¿”å›ä»€ä¹ˆ</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> createStore = <span class="function"><span class="keyword">function</span>(<span class="params">reducer</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> state = <span class="literal">null</span>;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// ç›‘å¬è€…ä»¬</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> listeners = [];</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> dispatch = <span class="function"><span class="keyword">function</span>(<span class="params">action</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">//</span></span></span><br><span class="line"><span class="javascript">          state = reducer(state, action); <span class="comment">// reducerè¿”å›æ–°çš„state</span></span></span><br><span class="line"><span class="javascript">          listeners.forEach(<span class="function"><span class="params">listener</span> =&gt;</span> listener());</span></span><br><span class="line">        &#125;;</span><br><span class="line">        dispatch(&#123;&#125;);</span><br><span class="line"><span class="javascript">        getState = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> state;</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="comment">// è®¢é˜…</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> subscribe = <span class="function"><span class="keyword">function</span>(<span class="params">listener</span>) </span>&#123;</span></span><br><span class="line">          listeners.push(listener);</span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line">          subscribe,</span><br><span class="line">          dispatch,</span><br><span class="line">          getState,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line"><span class="javascript">      <span class="comment">// store åŒ…å«subscribe,dispatch,getState</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> store = createStore(appReducer);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      store.subscribe(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">        render(store.getState());</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      store.subscribe(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(store.getState());</span></span><br><span class="line">      &#125;);</span><br><span class="line">      store.dispatch(&#123;</span><br><span class="line"><span class="javascript">        type: <span class="string">'CHANGE_TITLE'</span>,</span></span><br><span class="line"><span class="javascript">        newTitle: <span class="string">'this is new title'</span>,</span></span><br><span class="line">      &#125;);</span><br><span class="line">      render(store.getState());</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;åŸç”Ÿä»£ç &quot;&gt;&lt;a href=&quot;#åŸç”Ÿä»£ç &quot; class=&quot;headerlink&quot; title=&quot;åŸç”Ÿä»£ç &quot;&gt;&lt;/a&gt;åŸç”Ÿä»£ç &lt;/h2&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre
      
    
    </summary>
    
    
      <category term="redux" scheme="https://github.com/chengheai/tags/redux/"/>
    
  </entry>
  
  <entry>
    <title>jsåŸç”Ÿæ–¹æ³•å®ç°reactå¼€å‘æ¨¡å¼ä¸ç»„ä»¶åŒ–åŒ…è£…</title>
    <link href="https://github.com/chengheai/2020/02/25/js%E5%8E%9F%E7%94%9F%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0react%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F%E4%B8%8E%E7%BB%84%E4%BB%B6%E5%8C%96%E5%8C%85%E8%A3%85/"/>
    <id>https://github.com/chengheai/2020/02/25/jsåŸç”Ÿæ–¹æ³•å®ç°reactå¼€å‘æ¨¡å¼ä¸ç»„ä»¶åŒ–åŒ…è£…/</id>
    <published>2020-02-25T14:04:02.000Z</published>
    <updated>2021-10-20T14:10:38.966Z</updated>
    
    <content type="html"><![CDATA[<h2 id="react-åŸç”Ÿå¼€å‘æ¨¡å¼"><a href="#react-åŸç”Ÿå¼€å‘æ¨¡å¼" class="headerlink" title="react åŸç”Ÿå¼€å‘æ¨¡å¼"></a>react åŸç”Ÿå¼€å‘æ¨¡å¼</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ›´åŠ æ¥è¿‘reactçš„å¼€å‘æ¨¡å¼ --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> root = <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="comment">// çŠ¶æ€</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> state = &#123;</span></span><br><span class="line"><span class="javascript">        like: <span class="literal">false</span>,</span></span><br><span class="line">      &#125;;</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> setState = <span class="function"><span class="keyword">function</span>(<span class="params">newState</span>) </span>&#123;</span></span><br><span class="line">        state = &#123;</span><br><span class="line">          ...state,</span><br><span class="line">          ...newState,</span><br><span class="line">        &#125;;</span><br><span class="line">        render();</span><br><span class="line">      &#125;;</span><br><span class="line"><span class="javascript">      <span class="comment">// æ¸²æŸ“</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> render = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">        root.innerHTML = `</span><br><span class="line"><span class="javascript">      &lt;button type=<span class="string">'button'</span> style=<span class="string">'color:$&#123;state.like ? '</span>red<span class="string">' : '</span>black<span class="string">'&#125;'</span> onclick=<span class="string">'handleClick()'</span>&gt;</span></span><br><span class="line"><span class="javascript">      $&#123;state.like ? <span class="string">'å·²èµ'</span> : <span class="string">'å–œæ¬¢'</span>&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">      `;</span><br><span class="line">      &#125;;</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> handleClick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">        setState(&#123;</span><br><span class="line">          like: !state.like,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;;</span><br><span class="line">      render();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç»„ä»¶åŒ–åŒ…è£…"><a href="#ç»„ä»¶åŒ–åŒ…è£…" class="headerlink" title="ç»„ä»¶åŒ–åŒ…è£…"></a>ç»„ä»¶åŒ–åŒ…è£…</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ç»„ä»¶åŒ–åŒ…è£… --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> root = <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="comment">// æå–setStateæ–¹æ³•</span></span></span><br><span class="line"><span class="javascript">      <span class="class"><span class="keyword">class</span> <span class="title">Component</span> </span>&#123;</span></span><br><span class="line">        setState(newState) &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.state = &#123;</span></span><br><span class="line">            ...this.state,</span><br><span class="line">            ...newState,</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="comment">// extends ç»§æ‰¿ç»„ä»¶Componentçš„setStateæ–¹æ³• + super()</span></span></span><br><span class="line"><span class="javascript">      <span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">constructor</span>() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">super</span>();</span></span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.state = &#123;</span></span><br><span class="line"><span class="javascript">            like: <span class="literal">true</span>,</span></span><br><span class="line">          &#125;;</span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.render();</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="comment">// setState(newState) &#123;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   this.state = &#123;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//     ...this.state,</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//     newState</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   this.render()</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// &#125;</span></span></span><br><span class="line">        render() &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> state = <span class="keyword">this</span>.state;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="string">`</span></span></span><br><span class="line"><span class="javascript">           &lt;button type=<span class="string">'button'</span> style=<span class="string">'color:$&#123;state.like ? '</span>red<span class="string">' : '</span>black<span class="string">'&#125;'</span>&gt;</span></span><br><span class="line"><span class="javascript">      $&#123;state.like ? <span class="string">'å·²èµ'</span> : <span class="string">'å–œæ¬¢'</span>&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">        `;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="comment">// extends ç»§æ‰¿ç»„ä»¶Componentçš„setStateæ–¹æ³• + super()</span></span></span><br><span class="line"><span class="javascript">      <span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">constructor</span>() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">super</span>();</span></span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.state = &#123;</span></span><br><span class="line"><span class="javascript">            text: <span class="string">'è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜'</span>,</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="comment">// setState(newState) &#123;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   this.state = &#123;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//     ...this.state,</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//     newState</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// &#125;</span></span></span><br><span class="line">        render() &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="string">`&lt;h1&gt;<span class="subst">$&#123;<span class="keyword">this</span>.state.text&#125;</span>&lt;/h1&gt;`</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="comment">// ç»„ä»¶å¤ç”¨</span></span></span><br><span class="line"><span class="javascript">      <span class="class"><span class="keyword">class</span> <span class="title">Wrap</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">constructor</span>() &#123;&#125;</span></span><br><span class="line">        render() &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="string">`Wrap <span class="subst">$&#123;<span class="keyword">new</span> Title().render()&#125;</span> <span class="subst">$&#123;<span class="keyword">new</span> Button().render()&#125;</span>`</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      root.innerHTML = <span class="keyword">new</span> Wrap().render();</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;react-åŸç”Ÿå¼€å‘æ¨¡å¼&quot;&gt;&lt;a href=&quot;#react-åŸç”Ÿå¼€å‘æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;react åŸç”Ÿå¼€å‘æ¨¡å¼&quot;&gt;&lt;/a&gt;react åŸç”Ÿå¼€å‘æ¨¡å¼&lt;/h2&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;t
      
    
    </summary>
    
    
      <category term="react" scheme="https://github.com/chengheai/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>nodejsä¸­å¸¸è§çš„è·¨åŸŸå¤„ç†</title>
    <link href="https://github.com/chengheai/2020/02/23/nodejs%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E8%B7%A8%E5%9F%9F%E5%A4%84%E7%90%86/"/>
    <id>https://github.com/chengheai/2020/02/23/nodejsä¸­å¸¸è§çš„è·¨åŸŸå¤„ç†/</id>
    <published>2020-02-23T13:29:53.000Z</published>
    <updated>2021-10-20T14:10:38.966Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è·¨åŸŸé—®é¢˜"><a href="#è·¨åŸŸé—®é¢˜" class="headerlink" title="è·¨åŸŸé—®é¢˜"></a>è·¨åŸŸé—®é¢˜</h2><p>ajax åŒæºç­–ç•¥ åè®® ä¸»æœº(ip,åŸŸå) ç«¯å£å·</p><ol><li>åè®®ï¼Œç«¯å£</li><li>cors</li><li>header å¤´æ–‡ä»¶ä¿¡æ¯</li><li>jsonp</li><li>æœåŠ¡å™¨</li></ol><h2 id="è§£å†³-ğŸ§â€â™€ï¸"><a href="#è§£å†³-ğŸ§â€â™€ï¸" class="headerlink" title="è§£å†³ ğŸ§â€â™€ï¸"></a>è§£å†³ ğŸ§â€â™€ï¸</h2><blockquote><p>åè®®ï¼Œç«¯å£</p></blockquote><p>å°†è·¨åŸŸçš„æ–‡ä»¶æ”¾å…¥ä¸æœåŠ¡å™¨ä¸€æ ·çš„æ–‡ä»¶ä¸‹</p><blockquote><p>cors</p></blockquote><p>ä»¥ express ä¸ºä¾‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">'cors'</span>);</span><br><span class="line">...</span><br><span class="line">your codes...</span><br><span class="line">...</span><br><span class="line">app.use(cors());</span><br></pre></td></tr></table></figure><blockquote><p>header å¤´æ–‡ä»¶ä¿¡æ¯</p></blockquote><p>ä»¥ express ä¸ºä¾‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line">...</span><br><span class="line">your codes...</span><br><span class="line">...</span><br><span class="line">app.all(<span class="string">'*'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.header(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"*"</span>);</span><br><span class="line">    res.header(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"X-Requested-With,Content-Type"</span>);</span><br><span class="line">    res.header(<span class="string">"Access-Control-Allow-Methods"</span>,<span class="string">"PUT,POST,GET,DELETE,OPTIONS"</span>);</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>jsonp</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JSONP.getJSON(<span class="string">'http://api.com'</span>, data, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>æœåŠ¡å™¨</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">'request'</span>);</span><br><span class="line">...</span><br><span class="line">your codes...</span><br><span class="line">...</span><br><span class="line"><span class="comment">// æœ¬åœ°apiæ¥å£</span></span><br><span class="line">app.get(<span class="string">'/cors'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="comment">// å‘é€ä¸€ä¸ªæœåŠ¡å™¨è¯·æ±‚</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'cors.htmlçš„ajax'</span>);</span><br><span class="line">  <span class="comment">// ç›®æ ‡æœåŠ¡å™¨ï¼Œä½ æƒ³è¯·æ±‚çš„æœåŠ¡å™¨api</span></span><br><span class="line">  request(<span class="string">'http://www.google.com/xx/api/v1'</span>, (err, response, body) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(body);</span><br><span class="line">    <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">      res.send(body);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;è·¨åŸŸé—®é¢˜&quot;&gt;&lt;a href=&quot;#è·¨åŸŸé—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;è·¨åŸŸé—®é¢˜&quot;&gt;&lt;/a&gt;è·¨åŸŸé—®é¢˜&lt;/h2&gt;&lt;p&gt;ajax åŒæºç­–ç•¥ åè®® ä¸»æœº(ip,åŸŸå) ç«¯å£å·&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åè®®ï¼Œç«¯å£&lt;/li&gt;
&lt;li&gt;cors&lt;/l
      
    
    </summary>
    
    
      <category term="nodejs" scheme="https://github.com/chengheai/tags/nodejs/"/>
    
      <category term="è·¨åŸŸ" scheme="https://github.com/chengheai/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>å°ç¨‹åºä¸­ä¼˜é›…çš„è·å–æ‰‹æœºå·</title>
    <link href="https://github.com/chengheai/2020/01/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BC%98%E9%9B%85%E7%9A%84%E8%8E%B7%E5%8F%96%E6%89%8B%E6%9C%BA%E5%8F%B7/"/>
    <id>https://github.com/chengheai/2020/01/08/å°ç¨‹åºä¸­ä¼˜é›…çš„è·å–æ‰‹æœºå·/</id>
    <published>2020-01-08T13:33:09.000Z</published>
    <updated>2021-10-20T14:10:38.982Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨å†™å°ç¨‹åºé¡¹ç›®ï¼Œæœ‰ä¸ªè·å–æ‰‹æœºå·åŠŸèƒ½ï¼Œç½‘ä¸Šè¡äº†ä¸€ä¸‹ï¼Œè™½ä¸è¯´æ˜¯ä»£ç é—®é¢˜ï¼Œæœ‰äº›æ–‡ç« éƒ½æ˜¯æ®‹ç¼ºä¸å…¨çš„ï¼Œè¯´åˆ°å®¹æ˜“é”™è¯¯çš„åŒºåŸŸåˆå¹¶æœªä½¿ç”¨ä»£ç é¿å…ï¼Œè¯´è€Œä¸åšçš„é—®é¢˜ï¼Œç´¢æ€§è‡ªå·±ç»“åˆç½‘ä¸Šçš„æ–‡ç« åŠå®˜ç½‘æ–‡æ¡£å†™äº†ä¸€å¥—å®Œæ•´çš„ä»£ç ï¼Œå®Œå…¨å¼€ç®±å³ç”¨ ğŸ„ğŸ»â€â™‚ï¸ğŸ®ğŸ¹ğŸ¸</p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://github.com/chengheai/review-demo-image/blob/master/WX20200108-214825@2x.png?raw=true" alt title>                </div>                <div class="image-caption"></div>            </figure><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Page Object</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;&#125;,</span><br><span class="line">  getPhoneNumber: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'e'</span>, e);</span><br><span class="line">    <span class="comment">//-----------------æ˜¯å¦æˆæƒï¼Œæˆæƒé€šè¿‡è¿›å…¥ä¸»é¡µé¢ï¼Œæˆæƒæ‹’ç»åˆ™åœç•™åœ¨ç™»å½•ç•Œé¢</span></span><br><span class="line">    <span class="keyword">if</span> (e.detail.errMsg == <span class="string">'getPhoneNumber:fail user deny'</span>) &#123;</span><br><span class="line">      <span class="comment">//ç”¨æˆ·ç‚¹å‡»æ‹’ç»</span></span><br><span class="line">      wx.showModal(&#123;</span><br><span class="line">        content: <span class="string">'è¯·è¾“å…¥æ‰‹æœºå·'</span>,</span><br><span class="line">        showCancel: <span class="literal">false</span>,</span><br><span class="line">        success(res) &#123;</span><br><span class="line">          <span class="keyword">if</span> (res.confirm) &#123;</span><br><span class="line">            <span class="comment">// your code ...</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> phoneQuery = &#123;</span><br><span class="line">        encryptedData: e.detail.encryptedData,</span><br><span class="line">        iv: e.detail.iv,</span><br><span class="line">        <span class="comment">// other params...</span></span><br><span class="line">        openid: wx.getStorageSync(<span class="string">'openid'</span>),</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// æ£€æŸ¥æ˜¯session_keyå¦è¿‡æœŸ</span></span><br><span class="line">      wx.checkSession(&#123;</span><br><span class="line">        success() &#123;</span><br><span class="line">          <span class="comment">//session_key æœªè¿‡æœŸï¼Œå¹¶ä¸”åœ¨æœ¬ç”Ÿå‘½å‘¨æœŸä¸€ç›´æœ‰æ•ˆ</span></span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'session_key æœªè¿‡æœŸï¼Œå¹¶ä¸”åœ¨æœ¬ç”Ÿå‘½å‘¨æœŸä¸€ç›´æœ‰æ•ˆ'</span>);</span><br><span class="line">          wx.request(&#123;</span><br><span class="line">            url: <span class="string">'https://xxx.com/api/v1/xx'</span>,</span><br><span class="line">            method: <span class="string">'POST'</span>,</span><br><span class="line">            data: phoneQuery,</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">              <span class="comment">// your code...</span></span><br><span class="line">            &#125;,</span><br><span class="line">            fail: <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">              <span class="comment">// your code...</span></span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        fail() &#123;</span><br><span class="line">          that.myLogin();</span><br><span class="line">          <span class="comment">// session_key å·²ç»å¤±æ•ˆï¼Œéœ€è¦é‡æ–°æ‰§è¡Œç™»å½•æµç¨‹</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// login</span></span><br><span class="line">  myLogin() &#123;</span><br><span class="line">    wx.login(&#123;</span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//ç”¨codeä¼ ç»™æœåŠ¡å™¨è°ƒæ¢session_key</span></span><br><span class="line">        <span class="keyword">let</span> query = &#123;</span><br><span class="line">          code: res.code,</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// my_loginä¸ºwx.request(&#123;&#125;)å°è£…</span></span><br><span class="line">        my_login(query).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// other code...</span></span><br><span class="line">          wx.setStorageSync(<span class="string">'unionid'</span>, unionid);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//options(Object)</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;&#125;,</span><br><span class="line">  onReady: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onShow: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onHide: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onUnload: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onPullDownRefresh: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onReachBottom: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onShareAppMessage: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  onPageScroll: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  <span class="comment">//item(index,pagePath,text)</span></span><br><span class="line">  onTabItemTap: <span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;&#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ€è¿‘åœ¨å†™å°ç¨‹åºé¡¹ç›®ï¼Œæœ‰ä¸ªè·å–æ‰‹æœºå·åŠŸèƒ½ï¼Œç½‘ä¸Šè¡äº†ä¸€ä¸‹ï¼Œè™½ä¸è¯´æ˜¯ä»£ç é—®é¢˜ï¼Œæœ‰äº›æ–‡ç« éƒ½æ˜¯æ®‹ç¼ºä¸å…¨çš„ï¼Œè¯´åˆ°å®¹æ˜“é”™è¯¯çš„åŒºåŸŸåˆå¹¶æœªä½¿ç”¨ä»£ç é¿å…ï¼Œè¯´è€Œä¸
      
    
    </summary>
    
    
      <category term="å°ç¨‹åº" scheme="https://github.com/chengheai/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ€ä¹ˆä½¿ç”¨dockerè¿è¡Œnuxté¡¹ç›®</title>
    <link href="https://github.com/chengheai/2020/01/07/%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8docker%E8%BF%90%E8%A1%8Cnuxt%E9%A1%B9%E7%9B%AE/"/>
    <id>https://github.com/chengheai/2020/01/07/æ€ä¹ˆä½¿ç”¨dockerè¿è¡Œnuxté¡¹ç›®/</id>
    <published>2020-01-07T13:18:36.000Z</published>
    <updated>2021-10-20T14:10:38.983Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸ªäººæ—¥å¸¸-DEMO"><a href="#ä¸ªäººæ—¥å¸¸-DEMO" class="headerlink" title="ä¸ªäººæ—¥å¸¸ DEMO"></a>ä¸ªäººæ—¥å¸¸ DEMO</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:chengheai/ssr-project.git</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ -Dockerfile"><a href="#æ·»åŠ -Dockerfile" class="headerlink" title="æ·»åŠ  Dockerfile"></a>æ·»åŠ  Dockerfile</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">touch Dockerfile</span><br><span class="line">vi Dockerfile</span><br><span class="line">FROM node:<span class="number">8.11</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line">WORKDIR /opt</span><br><span class="line">ADD node_modules /opt/node_modules</span><br><span class="line">ADD server /opt/server</span><br><span class="line">ADD .nuxt /opt/.nuxt</span><br><span class="line">ADD <span class="keyword">static</span> /opt/<span class="keyword">static</span></span><br><span class="line">ADD nuxt.config.js /opt</span><br><span class="line">ADD package.json /opt</span><br><span class="line">EXPOSE <span class="number">3000</span></span><br><span class="line">CMD [<span class="string">"npm"</span>, <span class="string">"run"</span>, <span class="string">"start"</span>]</span><br></pre></td></tr></table></figure><p>~FROM node:8.11.0ï¼šè¯¥ image æ–‡ä»¶ç»§æ‰¿å®˜æ–¹çš„ node imageï¼Œå†’å·è¡¨ç¤ºæ ‡ç­¾ï¼Œè¿™é‡Œæ ‡ç­¾æ˜¯ 8.11.0ï¼Œå³ 8.11.0 ç‰ˆæœ¬çš„ nodeã€‚<br>~ADD . /optï¼šå°†å½“å‰ç›®å½•æ–‡ä»¶ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆé™¤äº†.dockerignore æ’é™¤çš„è·¯å¾„ï¼‰ï¼Œéƒ½æ‹·è´è¿›å…¥ image æ–‡ä»¶çš„/opt ç›®å½•ã€‚<br>~WORKDIR /optï¼šæŒ‡å®šæ¥ä¸‹æ¥çš„å·¥ä½œè·¯å¾„ä¸º/optã€‚<br>~RUN npm install æˆ–è€… ADD node_modulesï¼šåœ¨/opt ç›®å½•ä¸‹ï¼Œè¿è¡Œ npm install å‘½ä»¤å®‰è£…ä¾èµ–ã€‚æ³¨æ„ï¼Œå®‰è£…åæ‰€æœ‰çš„ä¾èµ–ï¼Œéƒ½å°†æ‰“åŒ…è¿›å…¥ image æ–‡ä»¶ã€‚<br>~EXPOSE 3000: 3000 ç«¯å£æš´éœ²å‡ºæ¥ï¼Œ å…è®¸å¤–éƒ¨è¿æ¥è¿™ä¸ªç«¯å£ã€‚</p><h2 id="æ·»åŠ -dockerignore"><a href="#æ·»åŠ -dockerignore" class="headerlink" title="æ·»åŠ .dockerignore"></a>æ·»åŠ .dockerignore</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">touch .dockerignore</span><br><span class="line">vi .dockerignore</span><br><span class="line">  .git</span><br><span class="line">  <span class="comment"># node_modules</span></span><br><span class="line">  npm-debug.log</span><br></pre></td></tr></table></figure><h2 id="build"><a href="#build" class="headerlink" title="build"></a>build</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker image build -t ssr-project.</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">docker image build -t ssr-project:0.0.1 .</span><br><span class="line"><span class="comment"># æœ€åé¢çš„ç©ºæ ¼å’Œç‚¹ä¸è¦æ¼</span></span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://github.com/chengheai/review-demo-image/blob/master/WechatIMG370.png?raw=true" alt title>                </div>                <div class="image-caption"></div>            </figure><h2 id="start"><a href="#start" class="headerlink" title="start"></a>start</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d --name ssr-server -p 3000:3000 <span class="built_in">test</span>-ssr</span><br><span class="line">ssr-server: å®¹å™¨åç§°</span><br><span class="line"><span class="built_in">test</span>-ssr: é•œåƒ</span><br><span class="line">å…³é—­</span><br><span class="line">$ docker stop ssr-server</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">okcer image ls // æŸ¥çœ‹ image</span><br><span class="line">docker image build -t ssr-project.  // å¸¸è§image</span><br><span class="line">docker rmi [containerID] // åˆ é™¤æŒ‡å®šé•œåƒ</span><br><span class="line">docker run -it --rm -p 3000:3000 ssr-project // docker container runå‘½ä»¤ä¼šä» image æ–‡ä»¶ç”Ÿæˆå®¹å™¨ã€‚--rmå‚æ•°ï¼Œåœ¨å®¹å™¨ç»ˆæ­¢è¿è¡Œåè‡ªåŠ¨åˆ é™¤å®¹å™¨æ–‡ä»¶</span><br><span class="line">docker ps // åˆ—å‡ºæœ¬æœºæ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker ps -a  // åˆ—å‡ºæœ¬æœºæ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬ç»ˆæ­¢è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker container ls // åˆ—å‡ºæœ¬æœºæ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker container ls --all // åˆ—å‡ºæœ¬æœºæ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬ç»ˆæ­¢è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker container rm [containerID] // åˆ é™¤æŒ‡å®šå®¹å™¨</span><br><span class="line">docker container <span class="built_in">kill</span> [containerID] // ç»ˆæ­¢å®¹å™¨è¿è¡Œï¼Œç›¸å½“äºå‘å®¹å™¨é‡Œé¢çš„ä¸»è¿›ç¨‹å‘å‡º SIGKILL ä¿¡å·</span><br><span class="line">docker container stop [containerID] // ç»ˆæ­¢å®¹å™¨è¿è¡Œï¼Œç›¸å½“äºå‘å®¹å™¨é‡Œé¢çš„ä¸»è¿›ç¨‹å‘å‡º SIGTERM ä¿¡å·ï¼Œç„¶åè¿‡ä¸€æ®µæ—¶é—´å†å‘å‡º SIGKILL ä¿¡å·</span><br><span class="line">docker container start [containerID] // å¯åŠ¨å·²ç»ç”Ÿæˆã€å·²ç»åœæ­¢è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker container logs [containerID] // ç”¨æ¥æŸ¥çœ‹ docker å®¹å™¨çš„è¾“å‡ºï¼Œå³å®¹å™¨é‡Œé¢ Shell çš„æ ‡å‡†è¾“å‡º</span><br><span class="line">docker container <span class="built_in">exec</span> -it [containerID] /bin/bash // ç”¨äºè¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ docker å®¹å™¨ è¿›å…¥å®¹å™¨å°±å¯ä»¥åœ¨å®¹å™¨çš„ Shell æ‰§è¡Œå‘½ä»¤äº†</span><br><span class="line">docker container cp [containID]:[/path/to/file] . // ç”¨äºä»æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨é‡Œé¢ï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°æœ¬æœº</span><br></pre></td></tr></table></figure><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p><a href="https://www.cnblogs.com/DeepInThought/p/10896790.html" target="_blank" rel="noopener">docker å¸¸ç”¨æŒ‡ä»¤è¯´æ˜</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä¸ªäººæ—¥å¸¸-DEMO&quot;&gt;&lt;a href=&quot;#ä¸ªäººæ—¥å¸¸-DEMO&quot; class=&quot;headerlink&quot; title=&quot;ä¸ªäººæ—¥å¸¸ DEMO&quot;&gt;&lt;/a&gt;ä¸ªäººæ—¥å¸¸ DEMO&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td
      
    
    </summary>
    
    
      <category term="docker" scheme="https://github.com/chengheai/tags/docker/"/>
    
  </entry>
  
</feed>
